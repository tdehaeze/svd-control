<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2020-11-25 mer. 09:32 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<title>Diagonal control using the SVD and the Jacobian Matrix</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Dehaeze Thomas" />
<link rel="stylesheet" type="text/css" href="https://research.tdehaeze.xyz/css/style.css"/>
<script type="text/javascript" src="https://research.tdehaeze.xyz/js/script.js"></script>
<script>MathJax = {
          tex: {
            tags: 'ams',
            macros: {bm: ["\\boldsymbol{#1}",1],}
            }
          };
          </script>
          <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="../index.html"> UP </a>
 |
 <a accesskey="H" href="../index.html"> HOME </a>
</div><div id="content">
<h1 class="title">Diagonal control using the SVD and the Jacobian Matrix</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org4bcea32">1. Gravimeter - Simscape Model</a>
<ul>
<li><a href="#org5f6e249">1.1. Introduction</a></li>
<li><a href="#org01cc89e">1.2. Gravimeter Model - Parameters</a></li>
<li><a href="#orgd1738d1">1.3. System Identification</a></li>
<li><a href="#org35c239c">1.4. Decoupling using the Jacobian</a></li>
<li><a href="#org6f938e2">1.5. Decoupling using the SVD</a></li>
<li><a href="#orgfabe265">1.6. Verification of the decoupling using the &ldquo;Gershgorin Radii&rdquo;</a></li>
<li><a href="#orgef088ef">1.7. Verification of the decoupling using the &ldquo;Relative Gain Array&rdquo;</a></li>
<li><a href="#org09b55fe">1.8. Obtained Decoupled Plants</a></li>
<li><a href="#orgfa6fc3b">1.9. Diagonal Controller</a></li>
<li><a href="#org78d9a5b">1.10. Closed-Loop system Performances</a></li>
</ul>
</li>
<li><a href="#orgce40d0e">2. Stewart Platform - Simscape Model</a>
<ul>
<li><a href="#org63cce53">2.1. Simscape Model - Parameters</a></li>
<li><a href="#org6cc3c6a">2.2. Identification of the plant</a></li>
<li><a href="#org6c203ed">2.3. Decoupling using the Jacobian</a></li>
<li><a href="#orgc3c9daf">2.4. Decoupling using the SVD</a></li>
<li><a href="#orga514e47">2.5. Verification of the decoupling using the &ldquo;Gershgorin Radii&rdquo;</a></li>
<li><a href="#orgd5f8212">2.6. Verification of the decoupling using the &ldquo;Relative Gain Array&rdquo;</a></li>
<li><a href="#org887521e">2.7. Obtained Decoupled Plants</a></li>
<li><a href="#orga134c9c">2.8. Diagonal Controller</a></li>
<li><a href="#org962b3f8">2.9. Closed-Loop system Performances</a></li>
</ul>
</li>
</ul>
</div>
</div>

<p>
In this document, the use of the Jacobian matrix and the Singular Value Decomposition to render a physical plant diagonal dominant is studied.
Then, a diagonal controller is used.
</p>

<p>
These two methods are tested on two plants:
</p>
<ul class="org-ul">
<li>In Section <a href="#orga85e8ac">1</a> on a 3-DoF gravimeter</li>
<li>In Section <a href="#orgc4fc4b3">2</a> on a 6-DoF Stewart platform</li>
</ul>

<div id="outline-container-org4bcea32" class="outline-2">
<h2 id="org4bcea32"><span class="section-number-2">1</span> Gravimeter - Simscape Model</h2>
<div class="outline-text-2" id="text-1">
<p>
<a id="orga85e8ac"></a>
</p>
</div>

<div id="outline-container-org5f6e249" class="outline-3">
<h3 id="org5f6e249"><span class="section-number-3">1.1</span> Introduction</h3>
<div class="outline-text-3" id="text-1-1">
<p>
In this part, diagonal control using both the SVD and the Jacobian matrices are applied on a gravimeter model:
</p>
<ul class="org-ul">
<li>Section <a href="#org516b437">1.2</a>: the model is described and its parameters are defined.</li>
<li>Section <a href="#org1c874d0">1.3</a>: the plant dynamics from the actuators to the sensors is computed from a Simscape model.</li>
<li>Section <a href="#org3e3089f">1.4</a>: the plant is decoupled using the Jacobian matrices.</li>
<li>Section <a href="#orgdb7c950">1.5</a>: the Singular Value Decomposition is performed on a real approximation of the plant transfer matrix and further use to decouple the system.</li>
<li>Section <a href="#org3ecdcf9">1.6</a>: the effectiveness of the decoupling is computed using the Gershorin radii</li>
<li>Section <a href="#org30ee3ad">1.7</a>: the effectiveness of the decoupling is computed using the Relative Gain Array</li>
<li>Section <a href="#org62590c4">1.8</a>: the obtained decoupled plants are compared</li>
<li>Section <a href="#orgf495bba">1.9</a>: the diagonal controller is developed</li>
<li>Section <a href="#org1a4c704">1.10</a>: the obtained closed-loop performances for the two methods are compared</li>
</ul>
</div>
</div>

<div id="outline-container-org01cc89e" class="outline-3">
<h3 id="org01cc89e"><span class="section-number-3">1.2</span> Gravimeter Model - Parameters</h3>
<div class="outline-text-3" id="text-1-2">
<p>
<a id="org516b437"></a>
</p>

<p>
The model of the gravimeter is schematically shown in Figure <a href="#orgb4b224e">1</a>.
</p>


<div id="orgb4b224e" class="figure">
<p><img src="figs/gravimeter_model.png" alt="gravimeter_model.png" />
</p>
<p><span class="figure-number">Figure 1: </span>Model of the gravimeter</p>
</div>

<p>
The parameters used for the simulation are the following:
</p>
<div class="org-src-container">
<pre class="src src-matlab">l  = 1.0; <span class="org-comment">% Length of the mass [m]</span>
h  = 1.7; <span class="org-comment">% Height of the mass [m]</span>

la = l<span class="org-type">/</span>2; <span class="org-comment">% Position of Act. [m]</span>
ha = h<span class="org-type">/</span>2; <span class="org-comment">% Position of Act. [m]</span>

m = 400; <span class="org-comment">% Mass [kg]</span>
I = 115; <span class="org-comment">% Inertia [kg m^2]</span>

k = 15e3; <span class="org-comment">% Actuator Stiffness [N/m]</span>
c = 2e1; <span class="org-comment">% Actuator Damping [N/(m/s)]</span>

deq = 0.2; <span class="org-comment">% Length of the actuators [m]</span>

g = 0; <span class="org-comment">% Gravity [m/s2]</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd1738d1" class="outline-3">
<h3 id="orgd1738d1"><span class="section-number-3">1.3</span> System Identification</h3>
<div class="outline-text-3" id="text-1-3">
<p>
<a id="org1c874d0"></a>
</p>

<div class="org-src-container">
<pre class="src src-matlab"><span class="org-matlab-cellbreak"><span class="org-comment">%% Name of the Simulink File</span></span>
mdl = <span class="org-string">'gravimeter'</span>;

<span class="org-matlab-cellbreak"><span class="org-comment">%% Input/Output definition</span></span>
clear io; io_i = 1;
io(io_i) = linio([mdl, <span class="org-string">'/F1'</span>], 1, <span class="org-string">'openinput'</span>);  io_i = io_i <span class="org-type">+</span> 1;
io(io_i) = linio([mdl, <span class="org-string">'/F2'</span>], 1, <span class="org-string">'openinput'</span>);  io_i = io_i <span class="org-type">+</span> 1;
io(io_i) = linio([mdl, <span class="org-string">'/F3'</span>], 1, <span class="org-string">'openinput'</span>);  io_i = io_i <span class="org-type">+</span> 1;
io(io_i) = linio([mdl, <span class="org-string">'/Acc_side'</span>], 1, <span class="org-string">'openoutput'</span>); io_i = io_i <span class="org-type">+</span> 1;
io(io_i) = linio([mdl, <span class="org-string">'/Acc_side'</span>], 2, <span class="org-string">'openoutput'</span>); io_i = io_i <span class="org-type">+</span> 1;
io(io_i) = linio([mdl, <span class="org-string">'/Acc_top'</span>], 1, <span class="org-string">'openoutput'</span>); io_i = io_i <span class="org-type">+</span> 1;
io(io_i) = linio([mdl, <span class="org-string">'/Acc_top'</span>], 2, <span class="org-string">'openoutput'</span>); io_i = io_i <span class="org-type">+</span> 1;

G = linearize(mdl, io);
G.InputName  = {<span class="org-string">'F1'</span>, <span class="org-string">'F2'</span>, <span class="org-string">'F3'</span>};
G.OutputName = {<span class="org-string">'Ax1'</span>, <span class="org-string">'Az1'</span>, <span class="org-string">'Ax2'</span>, <span class="org-string">'Az2'</span>};
</pre>
</div>

<p>
The inputs and outputs of the plant are shown in Figure <a href="#orgc747e56">2</a>.
</p>

<p>
More precisely there are three inputs (the three actuator forces):
</p>
\begin{equation}
  \bm{\tau} = \begin{bmatrix}\tau_1 \\ \tau_2 \\ \tau_2 \end{bmatrix}
\end{equation}
<p>
And 4 outputs (the two 2-DoF accelerometers):
</p>
\begin{equation}
  \bm{a} = \begin{bmatrix} a_{1x} \\ a_{1z} \\ a_{2x} \\ a_{2z} \end{bmatrix}
\end{equation}


<div id="orgc747e56" class="figure">
<p><img src="figs/gravimeter_plant_schematic.png" alt="gravimeter_plant_schematic.png" />
</p>
<p><span class="figure-number">Figure 2: </span>Schematic of the gravimeter plant</p>
</div>

<p>
We can check the poles of the plant:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">-0.12243+13.551i</td>
</tr>

<tr>
<td class="org-left">-0.12243-13.551i</td>
</tr>

<tr>
<td class="org-left">-0.05+8.6601i</td>
</tr>

<tr>
<td class="org-left">-0.05-8.6601i</td>
</tr>

<tr>
<td class="org-left">-0.0088785+3.6493i</td>
</tr>

<tr>
<td class="org-left">-0.0088785-3.6493i</td>
</tr>
</tbody>
</table>

<p>
As expected, the plant as 6 states (2 translations + 1 rotation)
</p>
<div class="org-src-container">
<pre class="src src-matlab">size(G)
</pre>
</div>

<pre class="example">
State-space model with 4 outputs, 3 inputs, and 6 states.
</pre>


<p>
The bode plot of all elements of the plant are shown in Figure <a href="#org85271f8">3</a>.
</p>


<div id="org85271f8" class="figure">
<p><img src="figs/open_loop_tf.png" alt="open_loop_tf.png" />
</p>
<p><span class="figure-number">Figure 3: </span>Open Loop Transfer Function from 3 Actuators to 4 Accelerometers</p>
</div>
</div>
</div>

<div id="outline-container-org35c239c" class="outline-3">
<h3 id="org35c239c"><span class="section-number-3">1.4</span> Decoupling using the Jacobian</h3>
<div class="outline-text-3" id="text-1-4">
<p>
<a id="org3e3089f"></a>
</p>

<p>
Consider the control architecture shown in Figure <a href="#org38ba9bc">4</a>.
</p>

<p>
The Jacobian matrix \(J_{\tau}\) is used to transform forces applied by the three actuators into forces/torques applied on the gravimeter at its center of mass:
</p>
\begin{equation}
  \begin{bmatrix} \tau_1 \\ \tau_2 \\ \tau_3 \end{bmatrix} = J_{\tau}^{-T} \begin{bmatrix} F_x \\ F_z \\ M_y \end{bmatrix}
\end{equation}

<p>
The Jacobian matrix \(J_{a}\) is used to compute the vertical acceleration, horizontal acceleration and rotational acceleration of the mass with respect to its center of mass:
</p>
\begin{equation}
  \begin{bmatrix} a_x \\ a_z \\ a_{R_y} \end{bmatrix} = J_{a}^{-1} \begin{bmatrix} a_{x1} \\ a_{z1} \\ a_{x2} \\ a_{z2} \end{bmatrix}
\end{equation}

<p>
We thus define a new plant as defined in Figure <a href="#org38ba9bc">4</a>.
\[ \bm{G}_x(s) = J_a^{-1} \bm{G}(s) J_{\tau}^{-T} \]
</p>

<p>
\(\bm{G}_x(s)\) correspond to the $3 &times; 3$transfer function matrix from forces and torques applied to the gravimeter at its center of mass to the absolute acceleration of the gravimeter&rsquo;s center of mass (Figure <a href="#org38ba9bc">4</a>).
</p>


<div id="org38ba9bc" class="figure">
<p><img src="figs/gravimeter_decouple_jacobian.png" alt="gravimeter_decouple_jacobian.png" />
</p>
<p><span class="figure-number">Figure 4: </span>Decoupled plant \(\bm{G}_x\) using the Jacobian matrix \(J\)</p>
</div>

<p>
The Jacobian corresponding to the sensors and actuators are defined below:
</p>
<div class="org-src-container">
<pre class="src src-matlab">Ja = [1 0  h<span class="org-type">/</span>2
      0 1 <span class="org-type">-</span>l<span class="org-type">/</span>2
      1 0 <span class="org-type">-</span>h<span class="org-type">/</span>2
      0 1  0];

Jt = [1 0  ha
      0 1 <span class="org-type">-</span>la
      0 1  la];
</pre>
</div>

<p>
And the plant \(\bm{G}_x\) is computed:
</p>
<div class="org-src-container">
<pre class="src src-matlab">Gx = pinv(Ja)<span class="org-type">*</span>G<span class="org-type">*</span>pinv(Jt<span class="org-type">'</span>);
Gx.InputName  = {<span class="org-string">'Fx'</span>, <span class="org-string">'Fz'</span>, <span class="org-string">'My'</span>};
Gx.OutputName  = {<span class="org-string">'Dx'</span>, <span class="org-string">'Dz'</span>, <span class="org-string">'Ry'</span>};
</pre>
</div>

<pre class="example">
size(Gx)
State-space model with 3 outputs, 3 inputs, and 6 states.
</pre>


<p>
The diagonal and off-diagonal elements of \(G_x\) are shown in Figure <a href="#orgee1af52">5</a>.
</p>


<div id="orgee1af52" class="figure">
<p><img src="figs/gravimeter_jacobian_plant.png" alt="gravimeter_jacobian_plant.png" />
</p>
<p><span class="figure-number">Figure 5: </span>Diagonal and off-diagonal elements of \(G_x\)</p>
</div>
</div>
</div>

<div id="outline-container-org6f938e2" class="outline-3">
<h3 id="org6f938e2"><span class="section-number-3">1.5</span> Decoupling using the SVD</h3>
<div class="outline-text-3" id="text-1-5">
<p>
<a id="orgdb7c950"></a>
</p>

<p>
In order to decouple the plant using the SVD, first a real approximation of the plant transfer function matrix as the crossover frequency is required.
</p>

<p>
Let&rsquo;s compute a real approximation of the complex matrix \(H_1\) which corresponds to the the transfer function \(G(j\omega_c)\) from forces applied by the actuators to the measured acceleration of the top platform evaluated at the frequency \(\omega_c\).
</p>
<div class="org-src-container">
<pre class="src src-matlab">wc = 2<span class="org-type">*</span><span class="org-constant">pi</span><span class="org-type">*</span>10; <span class="org-comment">% Decoupling frequency [rad/s]</span>

H1 = evalfr(G, <span class="org-constant">j</span><span class="org-type">*</span>wc);
</pre>
</div>

<p>
The real approximation is computed as follows:
</p>
<div class="org-src-container">
<pre class="src src-matlab">D = pinv(real(H1<span class="org-type">'*</span>H1));
H1 = pinv(D<span class="org-type">*</span>real(H1<span class="org-type">'*</span>diag(exp(<span class="org-constant">j</span><span class="org-type">*</span>angle(diag(H1<span class="org-type">*</span>D<span class="org-type">*</span>H1<span class="org-type">.'</span>))<span class="org-type">/</span>2))));
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 1:</span> Real approximate of \(G\) at the decoupling frequency \(\omega_c\)</caption>

<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">0.0092</td>
<td class="org-right">-0.0039</td>
<td class="org-right">0.0039</td>
</tr>

<tr>
<td class="org-right">-0.0039</td>
<td class="org-right">0.0048</td>
<td class="org-right">0.00028</td>
</tr>

<tr>
<td class="org-right">-0.004</td>
<td class="org-right">0.0038</td>
<td class="org-right">-0.0038</td>
</tr>

<tr>
<td class="org-right">8.4e-09</td>
<td class="org-right">0.0025</td>
<td class="org-right">0.0025</td>
</tr>
</tbody>
</table>


<p>
Now, the Singular Value Decomposition of \(H_1\) is performed:
\[ H_1 = U \Sigma V^H \]
</p>

<div class="org-src-container">
<pre class="src src-matlab">[U,S,V] = svd(H1);
</pre>
</div>

<p>
The obtained matrices \(U\) and \(V\) are used to decouple the system as shown in Figure <a href="#org5b03e6b">6</a>.
</p>


<div id="org5b03e6b" class="figure">
<p><img src="figs/gravimeter_decouple_svd.png" alt="gravimeter_decouple_svd.png" />
</p>
<p><span class="figure-number">Figure 6: </span>Decoupled plant \(\bm{G}_{SVD}\) using the Singular Value Decomposition</p>
</div>

<p>
The decoupled plant is then:
\[ \bm{G}_{SVD}(s) = U^{-1} \bm{G}(s) V^{-H} \]
</p>

<div class="org-src-container">
<pre class="src src-matlab">Gsvd = inv(U)<span class="org-type">*</span>G<span class="org-type">*</span>inv(V<span class="org-type">'</span>);
</pre>
</div>

<pre class="example">
size(Gsvd)
State-space model with 4 outputs, 3 inputs, and 6 states.
</pre>


<p>
The 4th output (corresponding to the null singular value) is discarded, and we only keep the \(3 \times 3\) plant:
</p>
<div class="org-src-container">
<pre class="src src-matlab">Gsvd = Gsvd(1<span class="org-type">:</span>3, 1<span class="org-type">:</span>3);
</pre>
</div>

<p>
The diagonal and off-diagonal elements of the &ldquo;SVD&rdquo; plant are shown in Figure <a href="#org941635f">7</a>.
</p>

<div id="org941635f" class="figure">
<p><img src="figs/gravimeter_svd_plant.png" alt="gravimeter_svd_plant.png" />
</p>
<p><span class="figure-number">Figure 7: </span>Diagonal and off-diagonal elements of \(G_{svd}\)</p>
</div>
</div>
</div>

<div id="outline-container-orgfabe265" class="outline-3">
<h3 id="orgfabe265"><span class="section-number-3">1.6</span> Verification of the decoupling using the &ldquo;Gershgorin Radii&rdquo;</h3>
<div class="outline-text-3" id="text-1-6">
<p>
<a id="org3ecdcf9"></a>
</p>

<p>
The &ldquo;Gershgorin Radii&rdquo; is computed for the coupled plant \(G(s)\), for the &ldquo;Jacobian plant&rdquo; \(G_x(s)\) and the &ldquo;SVD Decoupled Plant&rdquo; \(G_{SVD}(s)\):
</p>

<p>
The &ldquo;Gershgorin Radii&rdquo; of a matrix \(S\) is defined by:
\[ \zeta_i(j\omega) = \frac{\sum\limits_{j\neq i}|S_{ij}(j\omega)|}{|S_{ii}(j\omega)|} \]
</p>

<p>
This is computed over the following frequencies.
</p>
<div class="org-src-container">
<pre class="src src-matlab">freqs = logspace(<span class="org-type">-</span>2, 2, 1000); <span class="org-comment">% [Hz]</span>
</pre>
</div>


<div id="orgb00f2d8" class="figure">
<p><img src="figs/gravimeter_gershgorin_radii.png" alt="gravimeter_gershgorin_radii.png" />
</p>
<p><span class="figure-number">Figure 8: </span>Gershgorin Radii of the Coupled and Decoupled plants</p>
</div>
</div>
</div>

<div id="outline-container-orgef088ef" class="outline-3">
<h3 id="orgef088ef"><span class="section-number-3">1.7</span> Verification of the decoupling using the &ldquo;Relative Gain Array&rdquo;</h3>
<div class="outline-text-3" id="text-1-7">
<p>
<a id="org30ee3ad"></a>
</p>

<p>
The relative gain array (RGA) is defined as:
</p>
\begin{equation}
  \Lambda\big(G(s)\big) = G(s) \times \big( G(s)^{-1} \big)^T
\end{equation}
<p>
where \(\times\) denotes an element by element multiplication and \(G(s)\) is an \(n \times n\) square transfer matrix.
</p>

<p>
The obtained RGA elements are shown in Figure <a href="#orgee3b5aa">9</a>.
</p>


<div id="orgee3b5aa" class="figure">
<p><img src="figs/gravimeter_rga.png" alt="gravimeter_rga.png" />
</p>
<p><span class="figure-number">Figure 9: </span>Obtained norm of RGA elements for the SVD decoupled plant and the Jacobian decoupled plant</p>
</div>
</div>
</div>

<div id="outline-container-org09b55fe" class="outline-3">
<h3 id="org09b55fe"><span class="section-number-3">1.8</span> Obtained Decoupled Plants</h3>
<div class="outline-text-3" id="text-1-8">
<p>
<a id="org62590c4"></a>
</p>

<p>
The bode plot of the diagonal and off-diagonal elements of \(G_{SVD}\) are shown in Figure <a href="#org2e521bd">10</a>.
</p>


<div id="org2e521bd" class="figure">
<p><img src="figs/gravimeter_decoupled_plant_svd.png" alt="gravimeter_decoupled_plant_svd.png" />
</p>
<p><span class="figure-number">Figure 10: </span>Decoupled Plant using SVD</p>
</div>

<p>
Similarly, the bode plots of the diagonal elements and off-diagonal elements of the decoupled plant \(G_x(s)\) using the Jacobian are shown in Figure <a href="#org3605219">11</a>.
</p>


<div id="org3605219" class="figure">
<p><img src="figs/gravimeter_decoupled_plant_jacobian.png" alt="gravimeter_decoupled_plant_jacobian.png" />
</p>
<p><span class="figure-number">Figure 11: </span>Gravimeter Platform Plant from forces (resp. torques) applied by the legs to the acceleration (resp. angular acceleration) of the platform as well as all the coupling terms between the two (non-diagonal terms of the transfer function matrix)</p>
</div>
</div>
</div>

<div id="outline-container-orgfa6fc3b" class="outline-3">
<h3 id="orgfa6fc3b"><span class="section-number-3">1.9</span> Diagonal Controller</h3>
<div class="outline-text-3" id="text-1-9">
<p>
<a id="orgf495bba"></a>
The control diagram for the centralized control is shown in Figure <a href="#orgc82daae">12</a>.
</p>

<p>
The controller \(K_c\) is &ldquo;working&rdquo; in an cartesian frame.
The Jacobian is used to convert forces in the cartesian frame to forces applied by the actuators.
</p>


<div id="orgc82daae" class="figure">
<p><img src="figs/centralized_control_gravimeter.png" alt="centralized_control_gravimeter.png" />
</p>
<p><span class="figure-number">Figure 12: </span>Control Diagram for the Centralized control</p>
</div>

<p>
The SVD control architecture is shown in Figure <a href="#org70d4619">13</a>.
The matrices \(U\) and \(V\) are used to decoupled the plant \(G\).
</p>


<div id="org70d4619" class="figure">
<p><img src="figs/svd_control_gravimeter.png" alt="svd_control_gravimeter.png" />
</p>
<p><span class="figure-number">Figure 13: </span>Control Diagram for the SVD control</p>
</div>


<p>
We choose the controller to be a low pass filter:
\[ K_c(s) = \frac{G_0}{1 + \frac{s}{\omega_0}} \]
</p>

<p>
\(G_0\) is tuned such that the crossover frequency corresponding to the diagonal terms of the loop gain is equal to \(\omega_c\)
</p>

<div class="org-src-container">
<pre class="src src-matlab">wc = 2<span class="org-type">*</span><span class="org-constant">pi</span><span class="org-type">*</span>10;  <span class="org-comment">% Crossover Frequency [rad/s]</span>
w0 = 2<span class="org-type">*</span><span class="org-constant">pi</span><span class="org-type">*</span>0.1; <span class="org-comment">% Controller Pole [rad/s]</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-matlab">K_cen = diag(1<span class="org-type">./</span>diag(abs(evalfr(Gx, <span class="org-constant">j</span><span class="org-type">*</span>wc))))<span class="org-type">*</span>(1<span class="org-type">/</span>abs(evalfr(1<span class="org-type">/</span>(1 <span class="org-type">+</span> s<span class="org-type">/</span>w0), <span class="org-constant">j</span><span class="org-type">*</span>wc)))<span class="org-type">/</span>(1 <span class="org-type">+</span> s<span class="org-type">/</span>w0);
L_cen = K_cen<span class="org-type">*</span>Gx;
G_cen = feedback(G, pinv(Jt<span class="org-type">'</span>)<span class="org-type">*</span>K_cen<span class="org-type">*</span>pinv(Ja));
</pre>
</div>

<div class="org-src-container">
<pre class="src src-matlab">K_svd = diag(1<span class="org-type">./</span>diag(abs(evalfr(Gsvd, <span class="org-constant">j</span><span class="org-type">*</span>wc))))<span class="org-type">*</span>(1<span class="org-type">/</span>abs(evalfr(1<span class="org-type">/</span>(1 <span class="org-type">+</span> s<span class="org-type">/</span>w0), <span class="org-constant">j</span><span class="org-type">*</span>wc)))<span class="org-type">/</span>(1 <span class="org-type">+</span> s<span class="org-type">/</span>w0);
L_svd = K_svd<span class="org-type">*</span>Gsvd;
U_inv = inv(U);
G_svd = feedback(G, inv(V<span class="org-type">'</span>)<span class="org-type">*</span>K_svd<span class="org-type">*</span>U_inv(1<span class="org-type">:</span>3, <span class="org-type">:</span>));
</pre>
</div>

<p>
The obtained diagonal elements of the loop gains are shown in Figure <a href="#orgded6cd6">14</a>.
</p>


<div id="orgded6cd6" class="figure">
<p><img src="figs/gravimeter_comp_loop_gain_diagonal.png" alt="gravimeter_comp_loop_gain_diagonal.png" />
</p>
<p><span class="figure-number">Figure 14: </span>Comparison of the diagonal elements of the loop gains for the SVD control architecture and the Jacobian one</p>
</div>
</div>
</div>

<div id="outline-container-org78d9a5b" class="outline-3">
<h3 id="org78d9a5b"><span class="section-number-3">1.10</span> Closed-Loop system Performances</h3>
<div class="outline-text-3" id="text-1-10">
<p>
<a id="org1a4c704"></a>
</p>

<p>
Let&rsquo;s first verify the stability of the closed-loop systems:
</p>
<div class="org-src-container">
<pre class="src src-matlab">isstable(G_cen)
</pre>
</div>

<pre class="example">
ans =
  logical
   1
</pre>


<div class="org-src-container">
<pre class="src src-matlab">isstable(G_svd)
</pre>
</div>

<pre class="example">
ans =
  logical
   1
</pre>


<p>
The obtained transmissibility in Open-loop, for the centralized control as well as for the SVD control are shown in Figure <a href="#org9726280">15</a>.
</p>


<div id="org9726280" class="figure">
<p><img src="figs/gravimeter_platform_simscape_cl_transmissibility.png" alt="gravimeter_platform_simscape_cl_transmissibility.png" />
</p>
<p><span class="figure-number">Figure 15: </span>Obtained Transmissibility</p>
</div>
</div>
</div>
</div>

<div id="outline-container-orgce40d0e" class="outline-2">
<h2 id="orgce40d0e"><span class="section-number-2">2</span> Stewart Platform - Simscape Model</h2>
<div class="outline-text-2" id="text-2">
<p>
<a id="orgc4fc4b3"></a>
</p>
<p>
In this analysis, we wish to applied SVD control to the Stewart Platform shown in Figure <a href="#orge8ec29d">16</a>.
</p>

<p>
Some notes about the system:
</p>
<ul class="org-ul">
<li>6 voice coils actuators are used to control the motion of the top platform.</li>
<li>the motion of the top platform is measured with a 6-axis inertial unit (3 acceleration + 3 angular accelerations)</li>
<li>the control objective is to isolate the top platform from vibrations coming from the bottom platform</li>
</ul>


<div id="orge8ec29d" class="figure">
<p><img src="figs/SP_assembly.png" alt="SP_assembly.png" />
</p>
<p><span class="figure-number">Figure 16: </span>Stewart Platform CAD View</p>
</div>

<p>
The analysis of the SVD/Jacobian control applied to the Stewart platform is performed in the following sections:
</p>
<ul class="org-ul">
<li>Section <a href="#org00b1234">2.1</a>: The parameters of the Simscape model of the Stewart platform are defined</li>
<li>Section <a href="#org2fcc666">2.2</a>: The plant is identified from the Simscape model and the system coupling is shown</li>
<li>Section <a href="#org64578de">2.3</a>: The plant is first decoupled using the Jacobian</li>
<li>Section <a href="#org8e0706f">2.4</a>: The decoupling is performed thanks to the SVD. To do so a real approximation of the plant is computed.</li>
<li>Section <a href="#orgecdb237">2.5</a>: The effectiveness of the decoupling with the Jacobian and SVD are compared using the Gershorin Radii</li>
<li>Section <a href="#org577bb4e">2.6</a>:</li>
<li>Section <a href="#orgd33facb">2.7</a>: The dynamics of the decoupled plants are shown</li>
<li>Section <a href="#org4708058">2.8</a>: A diagonal controller is defined to control the decoupled plant</li>
<li>Section <a href="#orgc0d06ab">2.9</a>: Finally, the closed loop system properties are studied</li>
</ul>
</div>

<div id="outline-container-org63cce53" class="outline-3">
<h3 id="org63cce53"><span class="section-number-3">2.1</span> Simscape Model - Parameters</h3>
<div class="outline-text-3" id="text-2-1">
<p>
<a id="org00b1234"></a>
</p>
<div class="org-src-container">
<pre class="src src-matlab">open(<span class="org-string">'drone_platform.slx'</span>);
</pre>
</div>

<p>
Definition of spring parameters:
</p>
<div class="org-src-container">
<pre class="src src-matlab">kx = 0.5<span class="org-type">*</span>1e3<span class="org-type">/</span>3; <span class="org-comment">% [N/m]</span>
ky = 0.5<span class="org-type">*</span>1e3<span class="org-type">/</span>3;
kz = 1e3<span class="org-type">/</span>3;

cx = 0.025; <span class="org-comment">% [Nm/rad]</span>
cy = 0.025;
cz = 0.025;
</pre>
</div>

<p>
We suppose the sensor is perfectly positioned.
</p>
<div class="org-src-container">
<pre class="src src-matlab">sens_pos_error = zeros(3,1);
</pre>
</div>

<p>
Gravity:
</p>
<div class="org-src-container">
<pre class="src src-matlab">g = 0;
</pre>
</div>

<p>
We load the Jacobian (previously computed from the geometry):
</p>
<div class="org-src-container">
<pre class="src src-matlab">load(<span class="org-string">'jacobian.mat'</span>, <span class="org-string">'Aa'</span>, <span class="org-string">'Ab'</span>, <span class="org-string">'As'</span>, <span class="org-string">'l'</span>, <span class="org-string">'J'</span>);
</pre>
</div>

<p>
We initialize other parameters:
</p>
<div class="org-src-container">
<pre class="src src-matlab">U = eye(6);
V = eye(6);
Kc = tf(zeros(6));
</pre>
</div>


<div id="orgf441445" class="figure">
<p><img src="figs/stewart_simscape.png" alt="stewart_simscape.png" />
</p>
<p><span class="figure-number">Figure 17: </span>General view of the Simscape Model</p>
</div>


<div id="org11d6516" class="figure">
<p><img src="figs/stewart_platform_details.png" alt="stewart_platform_details.png" />
</p>
<p><span class="figure-number">Figure 18: </span>Simscape model of the Stewart platform</p>
</div>
</div>
</div>

<div id="outline-container-org6cc3c6a" class="outline-3">
<h3 id="org6cc3c6a"><span class="section-number-3">2.2</span> Identification of the plant</h3>
<div class="outline-text-3" id="text-2-2">
<p>
<a id="org2fcc666"></a>
</p>

<p>
The plant shown in Figure <a href="#org8b5b7dd">19</a> is identified from the Simscape model.
</p>

<p>
The inputs are:
</p>
<ul class="org-ul">
<li>\(D_w\) translation and rotation of the bottom platform (with respect to the center of mass of the top platform)</li>
<li>\(\tau\) the 6 forces applied by the voice coils</li>
</ul>

<p>
The outputs are the 6 accelerations measured by the inertial unit.
</p>


<div id="org8b5b7dd" class="figure">
<p><img src="figs/stewart_platform_plant.png" alt="stewart_platform_plant.png" />
</p>
<p><span class="figure-number">Figure 19: </span>Considered plant \(\bm{G} = \begin{bmatrix}G_d\\G_u\end{bmatrix}\). \(D_w\) is the translation/rotation of the support, \(\tau\) the actuator forces, \(a\) the acceleration/angular acceleration of the top platform</p>
</div>

<div class="org-src-container">
<pre class="src src-matlab"><span class="org-matlab-cellbreak"><span class="org-comment">%% Name of the Simulink File</span></span>
mdl = <span class="org-string">'drone_platform'</span>;

<span class="org-matlab-cellbreak"><span class="org-comment">%% Input/Output definition</span></span>
clear io; io_i = 1;
io(io_i) = linio([mdl, <span class="org-string">'/Dw'</span>],              1, <span class="org-string">'openinput'</span>);  io_i = io_i <span class="org-type">+</span> 1; <span class="org-comment">% Ground Motion</span>
io(io_i) = linio([mdl, <span class="org-string">'/V-T'</span>],             1, <span class="org-string">'openinput'</span>);  io_i = io_i <span class="org-type">+</span> 1; <span class="org-comment">% Actuator Forces</span>
io(io_i) = linio([mdl, <span class="org-string">'/Inertial Sensor'</span>], 1, <span class="org-string">'openoutput'</span>); io_i = io_i <span class="org-type">+</span> 1; <span class="org-comment">% Top platform acceleration</span>

G = linearize(mdl, io);
G.InputName  = {<span class="org-string">'Dwx'</span>, <span class="org-string">'Dwy'</span>, <span class="org-string">'Dwz'</span>, <span class="org-string">'Rwx'</span>, <span class="org-string">'Rwy'</span>, <span class="org-string">'Rwz'</span>, ...
                <span class="org-string">'F1'</span>, <span class="org-string">'F2'</span>, <span class="org-string">'F3'</span>, <span class="org-string">'F4'</span>, <span class="org-string">'F5'</span>, <span class="org-string">'F6'</span>};
G.OutputName = {<span class="org-string">'Ax'</span>, <span class="org-string">'Ay'</span>, <span class="org-string">'Az'</span>, <span class="org-string">'Arx'</span>, <span class="org-string">'Ary'</span>, <span class="org-string">'Arz'</span>};

<span class="org-comment">% Plant</span>
Gu = G(<span class="org-type">:</span>, {<span class="org-string">'F1'</span>, <span class="org-string">'F2'</span>, <span class="org-string">'F3'</span>, <span class="org-string">'F4'</span>, <span class="org-string">'F5'</span>, <span class="org-string">'F6'</span>});
<span class="org-comment">% Disturbance dynamics</span>
Gd = G(<span class="org-type">:</span>, {<span class="org-string">'Dwx'</span>, <span class="org-string">'Dwy'</span>, <span class="org-string">'Dwz'</span>, <span class="org-string">'Rwx'</span>, <span class="org-string">'Rwy'</span>, <span class="org-string">'Rwz'</span>});
</pre>
</div>

<p>
There are 24 states (6dof for the bottom platform + 6dof for the top platform).
</p>
<div class="org-src-container">
<pre class="src src-matlab">size(G)
</pre>
</div>

<pre class="example">
State-space model with 6 outputs, 12 inputs, and 24 states.
</pre>


<p>
The elements of the transfer matrix \(\bm{G}\) corresponding to the transfer function from actuator forces \(\tau\) to the measured acceleration \(a\) are shown in Figure <a href="#org248144c">20</a>.
</p>

<p>
One can easily see that the system is strongly coupled.
</p>


<div id="org248144c" class="figure">
<p><img src="figs/stewart_platform_coupled_plant.png" alt="stewart_platform_coupled_plant.png" />
</p>
<p><span class="figure-number">Figure 20: </span>Magnitude of all 36 elements of the transfer function matrix \(G_u\)</p>
</div>
</div>
</div>

<div id="outline-container-org6c203ed" class="outline-3">
<h3 id="org6c203ed"><span class="section-number-3">2.3</span> Decoupling using the Jacobian</h3>
<div class="outline-text-3" id="text-2-3">
<p>
<a id="org64578de"></a>
Consider the control architecture shown in Figure <a href="#org9a6d62d">21</a>.
The Jacobian matrix is used to transform forces/torques applied on the top platform to the equivalent forces applied by each actuator.
</p>

<p>
The Jacobian matrix is computed from the geometry of the platform (position and orientation of the actuators).
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 2:</span> Computed Jacobian Matrix</caption>

<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">0.811</td>
<td class="org-right">0.0</td>
<td class="org-right">0.584</td>
<td class="org-right">-0.018</td>
<td class="org-right">-0.008</td>
<td class="org-right">0.025</td>
</tr>

<tr>
<td class="org-right">-0.406</td>
<td class="org-right">-0.703</td>
<td class="org-right">0.584</td>
<td class="org-right">-0.016</td>
<td class="org-right">-0.012</td>
<td class="org-right">-0.025</td>
</tr>

<tr>
<td class="org-right">-0.406</td>
<td class="org-right">0.703</td>
<td class="org-right">0.584</td>
<td class="org-right">0.016</td>
<td class="org-right">-0.012</td>
<td class="org-right">0.025</td>
</tr>

<tr>
<td class="org-right">0.811</td>
<td class="org-right">0.0</td>
<td class="org-right">0.584</td>
<td class="org-right">0.018</td>
<td class="org-right">-0.008</td>
<td class="org-right">-0.025</td>
</tr>

<tr>
<td class="org-right">-0.406</td>
<td class="org-right">-0.703</td>
<td class="org-right">0.584</td>
<td class="org-right">0.002</td>
<td class="org-right">0.019</td>
<td class="org-right">0.025</td>
</tr>

<tr>
<td class="org-right">-0.406</td>
<td class="org-right">0.703</td>
<td class="org-right">0.584</td>
<td class="org-right">-0.002</td>
<td class="org-right">0.019</td>
<td class="org-right">-0.025</td>
</tr>
</tbody>
</table>


<div id="org9a6d62d" class="figure">
<p><img src="figs/plant_decouple_jacobian.png" alt="plant_decouple_jacobian.png" />
</p>
<p><span class="figure-number">Figure 21: </span>Decoupled plant \(\bm{G}_x\) using the Jacobian matrix \(J\)</p>
</div>

<p>
We define a new plant:
\[ G_x(s) = G(s) J^{-T} \]
</p>

<p>
\(G_x(s)\) correspond to the transfer function from forces and torques applied to the top platform to the absolute acceleration of the top platform.
</p>

<div class="org-src-container">
<pre class="src src-matlab">Gx = Gu<span class="org-type">*</span>inv(J<span class="org-type">'</span>);
Gx.InputName  = {<span class="org-string">'Fx'</span>, <span class="org-string">'Fy'</span>, <span class="org-string">'Fz'</span>, <span class="org-string">'Mx'</span>, <span class="org-string">'My'</span>, <span class="org-string">'Mz'</span>};
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc3c9daf" class="outline-3">
<h3 id="orgc3c9daf"><span class="section-number-3">2.4</span> Decoupling using the SVD</h3>
<div class="outline-text-3" id="text-2-4">
<p>
<a id="org8e0706f"></a>
</p>

<p>
In order to decouple the plant using the SVD, first a real approximation of the plant transfer function matrix as the crossover frequency is required.
</p>

<p>
Let&rsquo;s compute a real approximation of the complex matrix \(H_1\) which corresponds to the the transfer function \(G_u(j\omega_c)\) from forces applied by the actuators to the measured acceleration of the top platform evaluated at the frequency \(\omega_c\).
</p>
<div class="org-src-container">
<pre class="src src-matlab">wc = 2<span class="org-type">*</span><span class="org-constant">pi</span><span class="org-type">*</span>30; <span class="org-comment">% Decoupling frequency [rad/s]</span>

H1 = evalfr(Gu, <span class="org-constant">j</span><span class="org-type">*</span>wc);
</pre>
</div>

<p>
The real approximation is computed as follows:
</p>
<div class="org-src-container">
<pre class="src src-matlab">D = pinv(real(H1<span class="org-type">'*</span>H1));
H1 = inv(D<span class="org-type">*</span>real(H1<span class="org-type">'*</span>diag(exp(<span class="org-constant">j</span><span class="org-type">*</span>angle(diag(H1<span class="org-type">*</span>D<span class="org-type">*</span>H1<span class="org-type">.'</span>))<span class="org-type">/</span>2))));
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 3:</span> Real approximate of \(G\) at the decoupling frequency \(\omega_c\)</caption>

<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">4.4</td>
<td class="org-right">-2.1</td>
<td class="org-right">-2.1</td>
<td class="org-right">4.4</td>
<td class="org-right">-2.4</td>
<td class="org-right">-2.4</td>
</tr>

<tr>
<td class="org-right">-0.2</td>
<td class="org-right">-3.9</td>
<td class="org-right">3.9</td>
<td class="org-right">0.2</td>
<td class="org-right">-3.8</td>
<td class="org-right">3.8</td>
</tr>

<tr>
<td class="org-right">3.4</td>
<td class="org-right">3.4</td>
<td class="org-right">3.4</td>
<td class="org-right">3.4</td>
<td class="org-right">3.4</td>
<td class="org-right">3.4</td>
</tr>

<tr>
<td class="org-right">-367.1</td>
<td class="org-right">-323.8</td>
<td class="org-right">323.8</td>
<td class="org-right">367.1</td>
<td class="org-right">43.3</td>
<td class="org-right">-43.3</td>
</tr>

<tr>
<td class="org-right">-162.0</td>
<td class="org-right">-237.0</td>
<td class="org-right">-237.0</td>
<td class="org-right">-162.0</td>
<td class="org-right">398.9</td>
<td class="org-right">398.9</td>
</tr>

<tr>
<td class="org-right">220.6</td>
<td class="org-right">-220.6</td>
<td class="org-right">220.6</td>
<td class="org-right">-220.6</td>
<td class="org-right">220.6</td>
<td class="org-right">-220.6</td>
</tr>
</tbody>
</table>


<p>
Note that the plant \(G_u\) at \(\omega_c\) is already an almost real matrix.
This can be seen on the Bode plots where the phase is close to 1.
This can be verified below where only the real value of \(G_u(\omega_c)\) is shown
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 4:</span> Real part of \(G\) at the decoupling frequency \(\omega_c\)</caption>

<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">4.4</td>
<td class="org-right">-2.1</td>
<td class="org-right">-2.1</td>
<td class="org-right">4.4</td>
<td class="org-right">-2.4</td>
<td class="org-right">-2.4</td>
</tr>

<tr>
<td class="org-right">-0.2</td>
<td class="org-right">-3.9</td>
<td class="org-right">3.9</td>
<td class="org-right">0.2</td>
<td class="org-right">-3.8</td>
<td class="org-right">3.8</td>
</tr>

<tr>
<td class="org-right">3.4</td>
<td class="org-right">3.4</td>
<td class="org-right">3.4</td>
<td class="org-right">3.4</td>
<td class="org-right">3.4</td>
<td class="org-right">3.4</td>
</tr>

<tr>
<td class="org-right">-367.1</td>
<td class="org-right">-323.8</td>
<td class="org-right">323.8</td>
<td class="org-right">367.1</td>
<td class="org-right">43.3</td>
<td class="org-right">-43.3</td>
</tr>

<tr>
<td class="org-right">-162.0</td>
<td class="org-right">-237.0</td>
<td class="org-right">-237.0</td>
<td class="org-right">-162.0</td>
<td class="org-right">398.9</td>
<td class="org-right">398.9</td>
</tr>

<tr>
<td class="org-right">220.6</td>
<td class="org-right">-220.6</td>
<td class="org-right">220.6</td>
<td class="org-right">-220.6</td>
<td class="org-right">220.6</td>
<td class="org-right">-220.6</td>
</tr>
</tbody>
</table>

<p>
Now, the Singular Value Decomposition of \(H_1\) is performed:
\[ H_1 = U \Sigma V^H \]
</p>

<div class="org-src-container">
<pre class="src src-matlab">[U,<span class="org-type">~</span>,V] = svd(H1);
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 5:</span> Obtained matrix \(U\)</caption>

<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">-0.005</td>
<td class="org-right">7e-06</td>
<td class="org-right">6e-11</td>
<td class="org-right">-3e-06</td>
<td class="org-right">-1</td>
<td class="org-right">0.1</td>
</tr>

<tr>
<td class="org-right">-7e-06</td>
<td class="org-right">-0.005</td>
<td class="org-right">-9e-09</td>
<td class="org-right">-5e-09</td>
<td class="org-right">-0.1</td>
<td class="org-right">-1</td>
</tr>

<tr>
<td class="org-right">4e-08</td>
<td class="org-right">-2e-10</td>
<td class="org-right">-6e-11</td>
<td class="org-right">-1</td>
<td class="org-right">3e-06</td>
<td class="org-right">-3e-07</td>
</tr>

<tr>
<td class="org-right">-0.002</td>
<td class="org-right">-1</td>
<td class="org-right">-5e-06</td>
<td class="org-right">2e-10</td>
<td class="org-right">0.0006</td>
<td class="org-right">0.005</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-right">-0.002</td>
<td class="org-right">-1e-08</td>
<td class="org-right">2e-08</td>
<td class="org-right">-0.005</td>
<td class="org-right">0.0006</td>
</tr>

<tr>
<td class="org-right">-4e-09</td>
<td class="org-right">5e-06</td>
<td class="org-right">-1</td>
<td class="org-right">6e-11</td>
<td class="org-right">-2e-09</td>
<td class="org-right">-1e-08</td>
</tr>
</tbody>
</table>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 6:</span> Obtained matrix \(V\)</caption>

<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">-0.2</td>
<td class="org-right">0.5</td>
<td class="org-right">-0.4</td>
<td class="org-right">-0.4</td>
<td class="org-right">-0.6</td>
<td class="org-right">-0.2</td>
</tr>

<tr>
<td class="org-right">-0.3</td>
<td class="org-right">0.5</td>
<td class="org-right">0.4</td>
<td class="org-right">-0.4</td>
<td class="org-right">0.5</td>
<td class="org-right">0.3</td>
</tr>

<tr>
<td class="org-right">-0.3</td>
<td class="org-right">-0.5</td>
<td class="org-right">-0.4</td>
<td class="org-right">-0.4</td>
<td class="org-right">0.4</td>
<td class="org-right">-0.4</td>
</tr>

<tr>
<td class="org-right">-0.2</td>
<td class="org-right">-0.5</td>
<td class="org-right">0.4</td>
<td class="org-right">-0.4</td>
<td class="org-right">-0.5</td>
<td class="org-right">0.3</td>
</tr>

<tr>
<td class="org-right">0.6</td>
<td class="org-right">-0.06</td>
<td class="org-right">-0.4</td>
<td class="org-right">-0.4</td>
<td class="org-right">0.1</td>
<td class="org-right">0.6</td>
</tr>

<tr>
<td class="org-right">0.6</td>
<td class="org-right">0.06</td>
<td class="org-right">0.4</td>
<td class="org-right">-0.4</td>
<td class="org-right">-0.006</td>
<td class="org-right">-0.6</td>
</tr>
</tbody>
</table>

<p>
The obtained matrices \(U\) and \(V\) are used to decouple the system as shown in Figure <a href="#org6b45a64">22</a>.
</p>


<div id="org6b45a64" class="figure">
<p><img src="figs/plant_decouple_svd.png" alt="plant_decouple_svd.png" />
</p>
<p><span class="figure-number">Figure 22: </span>Decoupled plant \(\bm{G}_{SVD}\) using the Singular Value Decomposition</p>
</div>

<p>
The decoupled plant is then:
\[ G_{SVD}(s) = U^{-1} G_u(s) V^{-H} \]
</p>

<div class="org-src-container">
<pre class="src src-matlab">Gsvd = inv(U)<span class="org-type">*</span>Gu<span class="org-type">*</span>inv(V<span class="org-type">'</span>);
</pre>
</div>
</div>
</div>

<div id="outline-container-orga514e47" class="outline-3">
<h3 id="orga514e47"><span class="section-number-3">2.5</span> Verification of the decoupling using the &ldquo;Gershgorin Radii&rdquo;</h3>
<div class="outline-text-3" id="text-2-5">
<p>
<a id="orgecdb237"></a>
</p>

<p>
The &ldquo;Gershgorin Radii&rdquo; is computed for the coupled plant \(G(s)\), for the &ldquo;Jacobian plant&rdquo; \(G_x(s)\) and the &ldquo;SVD Decoupled Plant&rdquo; \(G_{SVD}(s)\):
</p>

<p>
The &ldquo;Gershgorin Radii&rdquo; of a matrix \(S\) is defined by:
\[ \zeta_i(j\omega) = \frac{\sum\limits_{j\neq i}|S_{ij}(j\omega)|}{|S_{ii}(j\omega)|} \]
</p>

<p>
This is computed over the following frequencies.
</p>

<div id="org78b193b" class="figure">
<p><img src="figs/simscape_model_gershgorin_radii.png" alt="simscape_model_gershgorin_radii.png" />
</p>
<p><span class="figure-number">Figure 23: </span>Gershgorin Radii of the Coupled and Decoupled plants</p>
</div>
</div>
</div>

<div id="outline-container-orgd5f8212" class="outline-3">
<h3 id="orgd5f8212"><span class="section-number-3">2.6</span> Verification of the decoupling using the &ldquo;Relative Gain Array&rdquo;</h3>
<div class="outline-text-3" id="text-2-6">
<p>
<a id="org577bb4e"></a>
</p>

<p>
The relative gain array (RGA) is defined as:
</p>
\begin{equation}
  \Lambda\big(G(s)\big) = G(s) \times \big( G(s)^{-1} \big)^T
\end{equation}
<p>
where \(\times\) denotes an element by element multiplication and \(G(s)\) is an \(n \times n\) square transfer matrix.
</p>

<p>
The obtained RGA elements are shown in Figure <a href="#org3af8336">24</a>.
</p>


<div id="org3af8336" class="figure">
<p><img src="figs/simscape_model_rga.png" alt="simscape_model_rga.png" />
</p>
<p><span class="figure-number">Figure 24: </span>Obtained norm of RGA elements for the SVD decoupled plant and the Jacobian decoupled plant</p>
</div>
</div>
</div>

<div id="outline-container-org887521e" class="outline-3">
<h3 id="org887521e"><span class="section-number-3">2.7</span> Obtained Decoupled Plants</h3>
<div class="outline-text-3" id="text-2-7">
<p>
<a id="orgd33facb"></a>
</p>

<p>
The bode plot of the diagonal and off-diagonal elements of \(G_{SVD}\) are shown in Figure <a href="#org013de60">25</a>.
</p>


<div id="org013de60" class="figure">
<p><img src="figs/simscape_model_decoupled_plant_svd.png" alt="simscape_model_decoupled_plant_svd.png" />
</p>
<p><span class="figure-number">Figure 25: </span>Decoupled Plant using SVD</p>
</div>

<p>
Similarly, the bode plots of the diagonal elements and off-diagonal elements of the decoupled plant \(G_x(s)\) using the Jacobian are shown in Figure <a href="#orgb13c9d7">26</a>.
</p>


<div id="orgb13c9d7" class="figure">
<p><img src="figs/simscape_model_decoupled_plant_jacobian.png" alt="simscape_model_decoupled_plant_jacobian.png" />
</p>
<p><span class="figure-number">Figure 26: </span>Stewart Platform Plant from forces (resp. torques) applied by the legs to the acceleration (resp. angular acceleration) of the platform as well as all the coupling terms between the two (non-diagonal terms of the transfer function matrix)</p>
</div>
</div>
</div>

<div id="outline-container-orga134c9c" class="outline-3">
<h3 id="orga134c9c"><span class="section-number-3">2.8</span> Diagonal Controller</h3>
<div class="outline-text-3" id="text-2-8">
<p>
<a id="org4708058"></a>
The control diagram for the centralized control is shown in Figure <a href="#org9680611">27</a>.
</p>

<p>
The controller \(K_c\) is &ldquo;working&rdquo; in an cartesian frame.
The Jacobian is used to convert forces in the cartesian frame to forces applied by the actuators.
</p>


<div id="org9680611" class="figure">
<p><img src="figs/centralized_control.png" alt="centralized_control.png" />
</p>
<p><span class="figure-number">Figure 27: </span>Control Diagram for the Centralized control</p>
</div>

<p>
The SVD control architecture is shown in Figure <a href="#org255f076">28</a>.
The matrices \(U\) and \(V\) are used to decoupled the plant \(G\).
</p>


<div id="org255f076" class="figure">
<p><img src="figs/svd_control.png" alt="svd_control.png" />
</p>
<p><span class="figure-number">Figure 28: </span>Control Diagram for the SVD control</p>
</div>


<p>
We choose the controller to be a low pass filter:
\[ K_c(s) = \frac{G_0}{1 + \frac{s}{\omega_0}} \]
</p>

<p>
\(G_0\) is tuned such that the crossover frequency corresponding to the diagonal terms of the loop gain is equal to \(\omega_c\)
</p>

<div class="org-src-container">
<pre class="src src-matlab">wc = 2<span class="org-type">*</span><span class="org-constant">pi</span><span class="org-type">*</span>80;  <span class="org-comment">% Crossover Frequency [rad/s]</span>
w0 = 2<span class="org-type">*</span><span class="org-constant">pi</span><span class="org-type">*</span>0.1; <span class="org-comment">% Controller Pole [rad/s]</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-matlab">K_cen = diag(1<span class="org-type">./</span>diag(abs(evalfr(Gx, <span class="org-constant">j</span><span class="org-type">*</span>wc))))<span class="org-type">*</span>(1<span class="org-type">/</span>abs(evalfr(1<span class="org-type">/</span>(1 <span class="org-type">+</span> s<span class="org-type">/</span>w0), <span class="org-constant">j</span><span class="org-type">*</span>wc)))<span class="org-type">/</span>(1 <span class="org-type">+</span> s<span class="org-type">/</span>w0);
L_cen = K_cen<span class="org-type">*</span>Gx;
G_cen = feedback(G, pinv(J<span class="org-type">'</span>)<span class="org-type">*</span>K_cen, [7<span class="org-type">:</span>12], [1<span class="org-type">:</span>6]);
</pre>
</div>

<div class="org-src-container">
<pre class="src src-matlab">K_svd = diag(1<span class="org-type">./</span>diag(abs(evalfr(Gsvd, <span class="org-constant">j</span><span class="org-type">*</span>wc))))<span class="org-type">*</span>(1<span class="org-type">/</span>abs(evalfr(1<span class="org-type">/</span>(1 <span class="org-type">+</span> s<span class="org-type">/</span>w0), <span class="org-constant">j</span><span class="org-type">*</span>wc)))<span class="org-type">/</span>(1 <span class="org-type">+</span> s<span class="org-type">/</span>w0);
L_svd = K_svd<span class="org-type">*</span>Gsvd;
G_svd = feedback(G, inv(V<span class="org-type">'</span>)<span class="org-type">*</span>K_svd<span class="org-type">*</span>inv(U), [7<span class="org-type">:</span>12], [1<span class="org-type">:</span>6]);
</pre>
</div>

<p>
The obtained diagonal elements of the loop gains are shown in Figure <a href="#orgf733562">29</a>.
</p>


<div id="orgf733562" class="figure">
<p><img src="figs/stewart_comp_loop_gain_diagonal.png" alt="stewart_comp_loop_gain_diagonal.png" />
</p>
<p><span class="figure-number">Figure 29: </span>Comparison of the diagonal elements of the loop gains for the SVD control architecture and the Jacobian one</p>
</div>
</div>
</div>

<div id="outline-container-org962b3f8" class="outline-3">
<h3 id="org962b3f8"><span class="section-number-3">2.9</span> Closed-Loop system Performances</h3>
<div class="outline-text-3" id="text-2-9">
<p>
<a id="orgc0d06ab"></a>
</p>

<p>
Let&rsquo;s first verify the stability of the closed-loop systems:
</p>
<div class="org-src-container">
<pre class="src src-matlab">isstable(G_cen)
</pre>
</div>

<pre class="example">
ans =
  logical
   1
</pre>


<div class="org-src-container">
<pre class="src src-matlab">isstable(G_svd)
</pre>
</div>

<pre class="example">
ans =
  logical
   1
</pre>


<p>
The obtained transmissibility in Open-loop, for the centralized control as well as for the SVD control are shown in Figure <a href="#orgc3d8e7f">30</a>.
</p>


<div id="orgc3d8e7f" class="figure">
<p><img src="figs/stewart_platform_simscape_cl_transmissibility.png" alt="stewart_platform_simscape_cl_transmissibility.png" />
</p>
<p><span class="figure-number">Figure 30: </span>Obtained Transmissibility</p>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Dehaeze Thomas</p>
<p class="date">Created: 2020-11-25 mer. 09:32</p>
</div>
</body>
</html>
