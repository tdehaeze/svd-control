<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-01-11 lun. 09:44 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<title>Diagonal control using the SVD and the Jacobian Matrix</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Dehaeze Thomas" />
<link rel="stylesheet" type="text/css" href="https://research.tdehaeze.xyz/css/style.css"/>
<script type="text/javascript" src="https://research.tdehaeze.xyz/js/script.js"></script>
<script>
           MathJax = {
             svg: {
               scale: 1,
               fontCache: "global"
             },
             tex: {
               tags: "ams",
               multlineWidth: "%MULTLINEWIDTH",
               tagSide: "right",
                       macros: {bm: ["\\boldsymbol{#1}",1],},
               tagIndent: ".8em"
             }
           };
           </script>
           <script id="MathJax-script" async
             src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="../index.html"> UP </a>
 |
 <a accesskey="H" href="../index.html"> HOME </a>
</div><div id="content">
<h1 class="title">Diagonal control using the SVD and the Jacobian Matrix</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orge484f08">1. Gravimeter - Simscape Model</a>
<ul>
<li><a href="#org05188f9">1.1. Introduction</a></li>
<li><a href="#org68957f9">1.2. Gravimeter Model - Parameters</a></li>
<li><a href="#org4e8571d">1.3. System Identification</a></li>
<li><a href="#org52e7ffa">1.4. Decoupling using the Jacobian</a></li>
<li><a href="#orga7b809a">1.5. Decoupling using the SVD</a></li>
<li><a href="#orga3385e8">1.6. Verification of the decoupling using the &ldquo;Gershgorin Radii&rdquo;</a></li>
<li><a href="#org4f18e2c">1.7. Verification of the decoupling using the &ldquo;Relative Gain Array&rdquo;</a></li>
<li><a href="#org1dc5427">1.8. Obtained Decoupled Plants</a></li>
<li><a href="#org672f55d">1.9. Diagonal Controller</a></li>
<li><a href="#org8df0c2b">1.10. Closed-Loop system Performances</a></li>
<li><a href="#org2929b71">1.11. Robustness to a change of actuator position</a></li>
<li><a href="#org800bce5">1.12. Choice of the reference frame for Jacobian decoupling</a>
<ul>
<li><a href="#org816fe65">1.12.1. Decoupling of the mass matrix</a></li>
<li><a href="#org9726b8e">1.12.2. Decoupling of the stiffness matrix</a></li>
<li><a href="#org7bd15d6">1.12.3. Combined decoupling of the mass and stiffness matrices</a></li>
<li><a href="#org0300070">1.12.4. Conclusion</a></li>
</ul>
</li>
<li><a href="#org5b4203f">1.13. SVD decoupling performances</a></li>
</ul>
</li>
<li><a href="#org401104a">2. Stewart Platform - Simscape Model</a>
<ul>
<li><a href="#org8c29905">2.1. Simscape Model - Parameters</a></li>
<li><a href="#orgd384200">2.2. Identification of the plant</a></li>
<li><a href="#orge1bb646">2.3. Decoupling using the Jacobian</a></li>
<li><a href="#org930cb6d">2.4. Decoupling using the SVD</a></li>
<li><a href="#org04da43f">2.5. Verification of the decoupling using the &ldquo;Gershgorin Radii&rdquo;</a></li>
<li><a href="#org0ef874f">2.6. Verification of the decoupling using the &ldquo;Relative Gain Array&rdquo;</a></li>
<li><a href="#orgd18fc2b">2.7. Obtained Decoupled Plants</a></li>
<li><a href="#org1bfaa13">2.8. Diagonal Controller</a></li>
<li><a href="#orgac71008">2.9. Closed-Loop system Performances</a></li>
</ul>
</li>
</ul>
</div>
</div>
<hr>
<p>This report is also available as a <a href="./index.pdf">pdf</a>.</p>
<hr>

<p>
In this document, the use of the Jacobian matrix and the Singular Value Decomposition to render a physical plant diagonal dominant is studied.
Then, a diagonal controller is used.
</p>

<p>
These two methods are tested on two plants:
</p>
<ul class="org-ul">
<li>In Section <a href="#org9cb0222">1</a> on a 3-DoF gravimeter</li>
<li>In Section <a href="#org7d4869d">2</a> on a 6-DoF Stewart platform</li>
</ul>

<div id="outline-container-orge484f08" class="outline-2">
<h2 id="orge484f08"><span class="section-number-2">1</span> Gravimeter - Simscape Model</h2>
<div class="outline-text-2" id="text-1">
<p>
<a id="org9cb0222"></a>
</p>
</div>

<div id="outline-container-org05188f9" class="outline-3">
<h3 id="org05188f9"><span class="section-number-3">1.1</span> Introduction</h3>
<div class="outline-text-3" id="text-1-1">
<p>
In this part, diagonal control using both the SVD and the Jacobian matrices are applied on a gravimeter model:
</p>
<ul class="org-ul">
<li>Section <a href="#org12b7eec">1.2</a>: the model is described and its parameters are defined.</li>
<li>Section <a href="#org658caff">1.3</a>: the plant dynamics from the actuators to the sensors is computed from a Simscape model.</li>
<li>Section <a href="#orgb4b0b08">1.4</a>: the plant is decoupled using the Jacobian matrices.</li>
<li>Section <a href="#orgfbb8ca8">1.5</a>: the Singular Value Decomposition is performed on a real approximation of the plant transfer matrix and further use to decouple the system.</li>
<li>Section <a href="#org65a6444">1.6</a>: the effectiveness of the decoupling is computed using the Gershorin radii</li>
<li>Section <a href="#org3d1bd13">1.7</a>: the effectiveness of the decoupling is computed using the Relative Gain Array</li>
<li>Section <a href="#org5a4a065">1.8</a>: the obtained decoupled plants are compared</li>
<li>Section <a href="#org2e164eb">1.9</a>: the diagonal controller is developed</li>
<li>Section <a href="#orgad5e534">1.10</a>: the obtained closed-loop performances for the two methods are compared</li>
<li>Section <a href="#org5192f2d">1.11</a>: the robustness to a change of actuator position is evaluated</li>
<li>Section <a href="#orged8a91f">1.12</a>: the choice of the reference frame for the evaluation of the Jacobian is discussed</li>
<li>Section <a href="#orgdb22a9c">1.13</a>: the decoupling performances of SVD is evaluated for a low damped and an highly damped system</li>
</ul>
</div>
</div>

<div id="outline-container-org68957f9" class="outline-3">
<h3 id="org68957f9"><span class="section-number-3">1.2</span> Gravimeter Model - Parameters</h3>
<div class="outline-text-3" id="text-1-2">
<p>
<a id="org12b7eec"></a>
</p>

<p>
The model of the gravimeter is schematically shown in Figure <a href="#orgdd323be">1</a>.
</p>


<div id="orgdd323be" class="figure">
<p><img src="figs/gravimeter_model.png" alt="gravimeter_model.png" />
</p>
<p><span class="figure-number">Figure 1: </span>Model of the gravimeter</p>
</div>


<div id="orga2a325d" class="figure">
<p><img src="figs/leg_model.png" alt="leg_model.png" />
</p>
<p><span class="figure-number">Figure 2: </span>Model of the struts</p>
</div>

<p>
The parameters used for the simulation are the following:
</p>
<div class="org-src-container">
<pre class="src src-matlab">l  = 1.0; <span class="org-comment">% Length of the mass [m]</span>
h  = 1.7; <span class="org-comment">% Height of the mass [m]</span>

la = l<span class="org-type">/</span>2; <span class="org-comment">% Position of Act. [m]</span>
ha = h<span class="org-type">/</span>2; <span class="org-comment">% Position of Act. [m]</span>

m = 400; <span class="org-comment">% Mass [kg]</span>
I = 115; <span class="org-comment">% Inertia [kg m^2]</span>

k = 15e3; <span class="org-comment">% Actuator Stiffness [N/m]</span>
c = 2e1; <span class="org-comment">% Actuator Damping [N/(m/s)]</span>

deq = 0.2; <span class="org-comment">% Length of the actuators [m]</span>

g = 0; <span class="org-comment">% Gravity [m/s2]</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org4e8571d" class="outline-3">
<h3 id="org4e8571d"><span class="section-number-3">1.3</span> System Identification</h3>
<div class="outline-text-3" id="text-1-3">
<p>
<a id="org658caff"></a>
</p>

<div class="org-src-container">
<pre class="src src-matlab"><span class="org-matlab-cellbreak"><span class="org-comment">%% Name of the Simulink File</span></span>
mdl = <span class="org-string">'gravimeter'</span>;

<span class="org-matlab-cellbreak"><span class="org-comment">%% Input/Output definition</span></span>
clear io; io_i = 1;
io(io_i) = linio([mdl, <span class="org-string">'/F1'</span>], 1, <span class="org-string">'openinput'</span>);  io_i = io_i <span class="org-type">+</span> 1;
io(io_i) = linio([mdl, <span class="org-string">'/F2'</span>], 1, <span class="org-string">'openinput'</span>);  io_i = io_i <span class="org-type">+</span> 1;
io(io_i) = linio([mdl, <span class="org-string">'/F3'</span>], 1, <span class="org-string">'openinput'</span>);  io_i = io_i <span class="org-type">+</span> 1;
io(io_i) = linio([mdl, <span class="org-string">'/Acc_side'</span>], 1, <span class="org-string">'openoutput'</span>); io_i = io_i <span class="org-type">+</span> 1;
io(io_i) = linio([mdl, <span class="org-string">'/Acc_side'</span>], 2, <span class="org-string">'openoutput'</span>); io_i = io_i <span class="org-type">+</span> 1;
io(io_i) = linio([mdl, <span class="org-string">'/Acc_top'</span>], 1, <span class="org-string">'openoutput'</span>); io_i = io_i <span class="org-type">+</span> 1;
io(io_i) = linio([mdl, <span class="org-string">'/Acc_top'</span>], 2, <span class="org-string">'openoutput'</span>); io_i = io_i <span class="org-type">+</span> 1;

G = linearize(mdl, io);
G.InputName  = {<span class="org-string">'F1'</span>, <span class="org-string">'F2'</span>, <span class="org-string">'F3'</span>};
G.OutputName = {<span class="org-string">'Ax1'</span>, <span class="org-string">'Ay1'</span>, <span class="org-string">'Ax2'</span>, <span class="org-string">'Ay2'</span>};
</pre>
</div>

<p>
The inputs and outputs of the plant are shown in Figure <a href="#orge3471b4">3</a>.
</p>

<p>
More precisely there are three inputs (the three actuator forces):
</p>
\begin{equation}
  \bm{\tau} = \begin{bmatrix}\tau_1 \\ \tau_2 \\ \tau_2 \end{bmatrix}
\end{equation}
<p>
And 4 outputs (the two 2-DoF accelerometers):
</p>
\begin{equation}
  \bm{a} = \begin{bmatrix} a_{1x} \\ a_{1y} \\ a_{2x} \\ a_{2y} \end{bmatrix}
\end{equation}


<div id="orge3471b4" class="figure">
<p><img src="figs/gravimeter_plant_schematic.png" alt="gravimeter_plant_schematic.png" />
</p>
<p><span class="figure-number">Figure 3: </span>Schematic of the gravimeter plant</p>
</div>

<p>
We can check the poles of the plant:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">-0.12243+13.551i</td>
</tr>

<tr>
<td class="org-left">-0.12243-13.551i</td>
</tr>

<tr>
<td class="org-left">-0.05+8.6601i</td>
</tr>

<tr>
<td class="org-left">-0.05-8.6601i</td>
</tr>

<tr>
<td class="org-left">-0.0088785+3.6493i</td>
</tr>

<tr>
<td class="org-left">-0.0088785-3.6493i</td>
</tr>
</tbody>
</table>

<p>
As expected, the plant as 6 states (2 translations + 1 rotation)
</p>
<div class="org-src-container">
<pre class="src src-matlab">size(G)
</pre>
</div>

<pre class="example">
State-space model with 4 outputs, 3 inputs, and 6 states.
</pre>


<p>
The bode plot of all elements of the plant are shown in Figure <a href="#orgb83b49c">4</a>.
</p>


<div id="orgb83b49c" class="figure">
<p><img src="figs/open_loop_tf.png" alt="open_loop_tf.png" />
</p>
<p><span class="figure-number">Figure 4: </span>Open Loop Transfer Function from 3 Actuators to 4 Accelerometers</p>
</div>
</div>
</div>

<div id="outline-container-org52e7ffa" class="outline-3">
<h3 id="org52e7ffa"><span class="section-number-3">1.4</span> Decoupling using the Jacobian</h3>
<div class="outline-text-3" id="text-1-4">
<p>
<a id="orgb4b0b08"></a>
</p>

<p>
Consider the control architecture shown in Figure <a href="#orgbfcf0fa">5</a>.
</p>

<p>
The Jacobian matrix \(J_{\tau}\) is used to transform forces applied by the three actuators into forces/torques applied on the gravimeter at its center of mass:
</p>
\begin{equation}
  \begin{bmatrix} \tau_1 \\ \tau_2 \\ \tau_3 \end{bmatrix} = J_{\tau}^{-T} \begin{bmatrix} F_x \\ F_y \\ M_z \end{bmatrix}
\end{equation}

<p>
The Jacobian matrix \(J_{a}\) is used to compute the vertical acceleration, horizontal acceleration and rotational acceleration of the mass with respect to its center of mass:
</p>
\begin{equation}
  \begin{bmatrix} a_x \\ a_y \\ a_{R_z} \end{bmatrix} = J_{a}^{-1} \begin{bmatrix} a_{x1} \\ a_{y1} \\ a_{x2} \\ a_{y2} \end{bmatrix}
\end{equation}

<p>
We thus define a new plant as defined in Figure <a href="#orgbfcf0fa">5</a>.
\[ \bm{G}_x(s) = J_a^{-1} \bm{G}(s) J_{\tau}^{-T} \]
</p>

<p>
\(\bm{G}_x(s)\) correspond to the \(3 \times 3\) transfer function matrix from forces and torques applied to the gravimeter at its center of mass to the absolute acceleration of the gravimeter&rsquo;s center of mass (Figure <a href="#orgbfcf0fa">5</a>).
</p>


<div id="orgbfcf0fa" class="figure">
<p><img src="figs/gravimeter_decouple_jacobian.png" alt="gravimeter_decouple_jacobian.png" />
</p>
<p><span class="figure-number">Figure 5: </span>Decoupled plant \(\bm{G}_x\) using the Jacobian matrix \(J\)</p>
</div>

<p>
The Jacobian corresponding to the sensors and actuators are defined below:
</p>
<div class="org-src-container">
<pre class="src src-matlab">Ja = [1 0 <span class="org-type">-</span>h<span class="org-type">/</span>2
      0 1  l<span class="org-type">/</span>2
      1 0  h<span class="org-type">/</span>2
      0 1  0];

Jt = [1 0 <span class="org-type">-</span>ha
      0 1  la
      0 1 <span class="org-type">-</span>la];
</pre>
</div>

<p>
And the plant \(\bm{G}_x\) is computed:
</p>
<div class="org-src-container">
<pre class="src src-matlab">Gx = pinv(Ja)<span class="org-type">*</span>G<span class="org-type">*</span>pinv(Jt<span class="org-type">'</span>);
Gx.InputName  = {<span class="org-string">'Fx'</span>, <span class="org-string">'Fy'</span>, <span class="org-string">'Mz'</span>};
Gx.OutputName  = {<span class="org-string">'Dx'</span>, <span class="org-string">'Dy'</span>, <span class="org-string">'Rz'</span>};
</pre>
</div>

<pre class="example">
size(Gx)
State-space model with 3 outputs, 3 inputs, and 6 states.
</pre>


<p>
The diagonal and off-diagonal elements of \(G_x\) are shown in Figure <a href="#org1726161">6</a>.
</p>

<p>
It is shown at the system is:
</p>
<ul class="org-ul">
<li>decoupled at high frequency thanks to a diagonal mass matrix (the Jacobian being evaluated at the center of mass of the payload)</li>
<li>coupled at low frequency due to the non-diagonal terms in the stiffness matrix, especially the term corresponding to a coupling between a force in the x direction to a rotation around z (due to the torque applied by the stiffness 1).</li>
</ul>

<p>
The choice of the frame in this the Jacobian is evaluated is discussed in Section <a href="#orged8a91f">1.12</a>.
</p>


<div id="org1726161" class="figure">
<p><img src="figs/gravimeter_jacobian_plant.png" alt="gravimeter_jacobian_plant.png" />
</p>
<p><span class="figure-number">Figure 6: </span>Diagonal and off-diagonal elements of \(G_x\)</p>
</div>
</div>
</div>

<div id="outline-container-orga7b809a" class="outline-3">
<h3 id="orga7b809a"><span class="section-number-3">1.5</span> Decoupling using the SVD</h3>
<div class="outline-text-3" id="text-1-5">
<p>
<a id="orgfbb8ca8"></a>
</p>

<p>
In order to decouple the plant using the SVD, first a real approximation of the plant transfer function matrix as the crossover frequency is required.
</p>

<p>
Let&rsquo;s compute a real approximation of the complex matrix \(H_1\) which corresponds to the the transfer function \(G(j\omega_c)\) from forces applied by the actuators to the measured acceleration of the top platform evaluated at the frequency \(\omega_c\).
</p>
<div class="org-src-container">
<pre class="src src-matlab">wc = 2<span class="org-type">*</span><span class="org-constant">pi</span><span class="org-type">*</span>10; <span class="org-comment">% Decoupling frequency [rad/s]</span>

H1 = evalfr(G, <span class="org-constant">j</span><span class="org-type">*</span>wc);
</pre>
</div>

<p>
The real approximation is computed as follows:
</p>
<div class="org-src-container">
<pre class="src src-matlab">D = pinv(real(H1<span class="org-type">'*</span>H1));
H1 = pinv(D<span class="org-type">*</span>real(H1<span class="org-type">'*</span>diag(exp(<span class="org-constant">j</span><span class="org-type">*</span>angle(diag(H1<span class="org-type">*</span>D<span class="org-type">*</span>H1<span class="org-type">.'</span>))<span class="org-type">/</span>2))));
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 1:</span> Real approximate of \(G\) at the decoupling frequency \(\omega_c\)</caption>

<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">0.0092</td>
<td class="org-right">-0.0039</td>
<td class="org-right">0.0039</td>
</tr>

<tr>
<td class="org-right">-0.0039</td>
<td class="org-right">0.0048</td>
<td class="org-right">0.00028</td>
</tr>

<tr>
<td class="org-right">-0.004</td>
<td class="org-right">0.0038</td>
<td class="org-right">-0.0038</td>
</tr>

<tr>
<td class="org-right">8.4e-09</td>
<td class="org-right">0.0025</td>
<td class="org-right">0.0025</td>
</tr>
</tbody>
</table>


<p>
Now, the Singular Value Decomposition of \(H_1\) is performed:
\[ H_1 = U \Sigma V^H \]
</p>

<div class="org-src-container">
<pre class="src src-matlab">[U,S,V] = svd(H1);
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 2:</span> \(U\) matrix</caption>

<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">-0.78</td>
<td class="org-right">0.26</td>
<td class="org-right">-0.53</td>
<td class="org-right">-0.2</td>
</tr>

<tr>
<td class="org-right">0.4</td>
<td class="org-right">0.61</td>
<td class="org-right">-0.04</td>
<td class="org-right">-0.68</td>
</tr>

<tr>
<td class="org-right">0.48</td>
<td class="org-right">-0.14</td>
<td class="org-right">-0.85</td>
<td class="org-right">0.2</td>
</tr>

<tr>
<td class="org-right">0.03</td>
<td class="org-right">0.73</td>
<td class="org-right">0.06</td>
<td class="org-right">0.68</td>
</tr>
</tbody>
</table>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 3:</span> \(V\) matrix</caption>

<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">-0.79</td>
<td class="org-right">0.11</td>
<td class="org-right">-0.6</td>
</tr>

<tr>
<td class="org-right">0.51</td>
<td class="org-right">0.67</td>
<td class="org-right">-0.54</td>
</tr>

<tr>
<td class="org-right">-0.35</td>
<td class="org-right">0.73</td>
<td class="org-right">0.59</td>
</tr>
</tbody>
</table>

<p>
The obtained matrices \(U\) and \(V\) are used to decouple the system as shown in Figure <a href="#orge9ba5eb">7</a>.
</p>


<div id="orge9ba5eb" class="figure">
<p><img src="figs/gravimeter_decouple_svd.png" alt="gravimeter_decouple_svd.png" />
</p>
<p><span class="figure-number">Figure 7: </span>Decoupled plant \(\bm{G}_{SVD}\) using the Singular Value Decomposition</p>
</div>

<p>
The decoupled plant is then:
\[ \bm{G}_{SVD}(s) = U^{-1} \bm{G}(s) V^{-H} \]
</p>

<div class="org-src-container">
<pre class="src src-matlab">Gsvd = inv(U)<span class="org-type">*</span>G<span class="org-type">*</span>inv(V<span class="org-type">'</span>);
</pre>
</div>

<pre class="example">
size(Gsvd)
State-space model with 4 outputs, 3 inputs, and 6 states.
</pre>


<p>
The 4th output (corresponding to the null singular value) is discarded, and we only keep the \(3 \times 3\) plant:
</p>
<div class="org-src-container">
<pre class="src src-matlab">Gsvd = Gsvd(1<span class="org-type">:</span>3, 1<span class="org-type">:</span>3);
</pre>
</div>

<p>
The diagonal and off-diagonal elements of the &ldquo;SVD&rdquo; plant are shown in Figure <a href="#orgd5bf81c">8</a>.
</p>

<div id="orgd5bf81c" class="figure">
<p><img src="figs/gravimeter_svd_plant.png" alt="gravimeter_svd_plant.png" />
</p>
<p><span class="figure-number">Figure 8: </span>Diagonal and off-diagonal elements of \(G_{svd}\)</p>
</div>
</div>
</div>

<div id="outline-container-orga3385e8" class="outline-3">
<h3 id="orga3385e8"><span class="section-number-3">1.6</span> Verification of the decoupling using the &ldquo;Gershgorin Radii&rdquo;</h3>
<div class="outline-text-3" id="text-1-6">
<p>
<a id="org65a6444"></a>
</p>

<p>
The &ldquo;Gershgorin Radii&rdquo; is computed for the coupled plant \(G(s)\), for the &ldquo;Jacobian plant&rdquo; \(G_x(s)\) and the &ldquo;SVD Decoupled Plant&rdquo; \(G_{SVD}(s)\):
</p>

<p>
The &ldquo;Gershgorin Radii&rdquo; of a matrix \(S\) is defined by:
\[ \zeta_i(j\omega) = \frac{\sum\limits_{j\neq i}|S_{ij}(j\omega)|}{|S_{ii}(j\omega)|} \]
</p>


<div id="org05c8346" class="figure">
<p><img src="figs/gravimeter_gershgorin_radii.png" alt="gravimeter_gershgorin_radii.png" />
</p>
<p><span class="figure-number">Figure 9: </span>Gershgorin Radii of the Coupled and Decoupled plants</p>
</div>
</div>
</div>

<div id="outline-container-org4f18e2c" class="outline-3">
<h3 id="org4f18e2c"><span class="section-number-3">1.7</span> Verification of the decoupling using the &ldquo;Relative Gain Array&rdquo;</h3>
<div class="outline-text-3" id="text-1-7">
<p>
<a id="org3d1bd13"></a>
</p>

<p>
The relative gain array (RGA) is defined as:
</p>
\begin{equation}
  \Lambda\big(G(s)\big) = G(s) \times \big( G(s)^{-1} \big)^T
\end{equation}
<p>
where \(\times\) denotes an element by element multiplication and \(G(s)\) is an \(n \times n\) square transfer matrix.
</p>

<p>
The obtained RGA elements are shown in Figure <a href="#org6973c90">10</a>.
</p>


<div id="org6973c90" class="figure">
<p><img src="figs/gravimeter_rga.png" alt="gravimeter_rga.png" />
</p>
<p><span class="figure-number">Figure 10: </span>Obtained norm of RGA elements for the SVD decoupled plant and the Jacobian decoupled plant</p>
</div>

<p>
The RGA-number is also a measure of diagonal dominance:
</p>
\begin{equation}
  \text{RGA-number} = \| \Lambda(G) - I \|_\text{sum}
\end{equation}


<div id="org8813fff" class="figure">
<p><img src="figs/gravimeter_rga_num.png" alt="gravimeter_rga_num.png" />
</p>
<p><span class="figure-number">Figure 11: </span>RGA-Number for the Gravimeter</p>
</div>
</div>
</div>

<div id="outline-container-org1dc5427" class="outline-3">
<h3 id="org1dc5427"><span class="section-number-3">1.8</span> Obtained Decoupled Plants</h3>
<div class="outline-text-3" id="text-1-8">
<p>
<a id="org5a4a065"></a>
</p>

<p>
The bode plot of the diagonal and off-diagonal elements of \(G_{SVD}\) are shown in Figure <a href="#org2886906">12</a>.
</p>


<div id="org2886906" class="figure">
<p><img src="figs/gravimeter_decoupled_plant_svd.png" alt="gravimeter_decoupled_plant_svd.png" />
</p>
<p><span class="figure-number">Figure 12: </span>Decoupled Plant using SVD</p>
</div>

<p>
Similarly, the bode plots of the diagonal elements and off-diagonal elements of the decoupled plant \(G_x(s)\) using the Jacobian are shown in Figure <a href="#org4aa85a1">13</a>.
</p>


<div id="org4aa85a1" class="figure">
<p><img src="figs/gravimeter_decoupled_plant_jacobian.png" alt="gravimeter_decoupled_plant_jacobian.png" />
</p>
<p><span class="figure-number">Figure 13: </span>Gravimeter Platform Plant from forces (resp. torques) applied by the legs to the acceleration (resp. angular acceleration) of the platform as well as all the coupling terms between the two (non-diagonal terms of the transfer function matrix)</p>
</div>
</div>
</div>

<div id="outline-container-org672f55d" class="outline-3">
<h3 id="org672f55d"><span class="section-number-3">1.9</span> Diagonal Controller</h3>
<div class="outline-text-3" id="text-1-9">
<p>
<a id="org2e164eb"></a>
The control diagram for the centralized control is shown in Figure <a href="#orga988779">14</a>.
</p>

<p>
The controller \(K_c\) is &ldquo;working&rdquo; in an cartesian frame.
The Jacobian is used to convert forces in the cartesian frame to forces applied by the actuators.
</p>


<div id="orga988779" class="figure">
<p><img src="figs/centralized_control_gravimeter.png" alt="centralized_control_gravimeter.png" />
</p>
<p><span class="figure-number">Figure 14: </span>Control Diagram for the Centralized control</p>
</div>

<p>
The SVD control architecture is shown in Figure <a href="#org40e5f50">15</a>.
The matrices \(U\) and \(V\) are used to decoupled the plant \(G\).
</p>


<div id="org40e5f50" class="figure">
<p><img src="figs/svd_control_gravimeter.png" alt="svd_control_gravimeter.png" />
</p>
<p><span class="figure-number">Figure 15: </span>Control Diagram for the SVD control</p>
</div>


<p>
We choose the controller to be a low pass filter:
\[ K_c(s) = \frac{G_0}{1 + \frac{s}{\omega_0}} \]
</p>

<p>
\(G_0\) is tuned such that the crossover frequency corresponding to the diagonal terms of the loop gain is equal to \(\omega_c\)
</p>

<div class="org-src-container">
<pre class="src src-matlab">wc = 2<span class="org-type">*</span><span class="org-constant">pi</span><span class="org-type">*</span>10;  <span class="org-comment">% Crossover Frequency [rad/s]</span>
w0 = 2<span class="org-type">*</span><span class="org-constant">pi</span><span class="org-type">*</span>0.1; <span class="org-comment">% Controller Pole [rad/s]</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-matlab">K_cen = diag(1<span class="org-type">./</span>diag(abs(evalfr(Gx, <span class="org-constant">j</span><span class="org-type">*</span>wc))))<span class="org-type">*</span>(1<span class="org-type">/</span>abs(evalfr(1<span class="org-type">/</span>(1 <span class="org-type">+</span> s<span class="org-type">/</span>w0), <span class="org-constant">j</span><span class="org-type">*</span>wc)))<span class="org-type">/</span>(1 <span class="org-type">+</span> s<span class="org-type">/</span>w0);
L_cen = K_cen<span class="org-type">*</span>Gx;
G_cen = feedback(G, pinv(Jt<span class="org-type">'</span>)<span class="org-type">*</span>K_cen<span class="org-type">*</span>pinv(Ja));
</pre>
</div>

<div class="org-src-container">
<pre class="src src-matlab">K_svd = diag(1<span class="org-type">./</span>diag(abs(evalfr(Gsvd, <span class="org-constant">j</span><span class="org-type">*</span>wc))))<span class="org-type">*</span>(1<span class="org-type">/</span>abs(evalfr(1<span class="org-type">/</span>(1 <span class="org-type">+</span> s<span class="org-type">/</span>w0), <span class="org-constant">j</span><span class="org-type">*</span>wc)))<span class="org-type">/</span>(1 <span class="org-type">+</span> s<span class="org-type">/</span>w0);
L_svd = K_svd<span class="org-type">*</span>Gsvd;
U_inv = inv(U);
G_svd = feedback(G, inv(V<span class="org-type">'</span>)<span class="org-type">*</span>K_svd<span class="org-type">*</span>U_inv(1<span class="org-type">:</span>3, <span class="org-type">:</span>));
</pre>
</div>

<p>
The obtained diagonal elements of the loop gains are shown in Figure <a href="#org78a7698">16</a>.
</p>


<div id="org78a7698" class="figure">
<p><img src="figs/gravimeter_comp_loop_gain_diagonal.png" alt="gravimeter_comp_loop_gain_diagonal.png" />
</p>
<p><span class="figure-number">Figure 16: </span>Comparison of the diagonal elements of the loop gains for the SVD control architecture and the Jacobian one</p>
</div>
</div>
</div>

<div id="outline-container-org8df0c2b" class="outline-3">
<h3 id="org8df0c2b"><span class="section-number-3">1.10</span> Closed-Loop system Performances</h3>
<div class="outline-text-3" id="text-1-10">
<p>
<a id="orgad5e534"></a>
</p>

<p>
Let&rsquo;s first verify the stability of the closed-loop systems:
</p>
<div class="org-src-container">
<pre class="src src-matlab">isstable(G_cen)
</pre>
</div>

<pre class="example">
ans =
  logical
   1
</pre>


<div class="org-src-container">
<pre class="src src-matlab">isstable(G_svd)
</pre>
</div>

<pre class="example">
ans =
  logical
   1
</pre>


<p>
The obtained transmissibility in Open-loop, for the centralized control as well as for the SVD control are shown in Figure <a href="#org532d1f2">17</a>.
</p>


<div id="org532d1f2" class="figure">
<p><img src="figs/gravimeter_platform_simscape_cl_transmissibility.png" alt="gravimeter_platform_simscape_cl_transmissibility.png" />
</p>
<p><span class="figure-number">Figure 17: </span>Obtained Transmissibility</p>
</div>


<div id="org88d03af" class="figure">
<p><img src="figs/gravimeter_cl_transmissibility_coupling.png" alt="gravimeter_cl_transmissibility_coupling.png" />
</p>
<p><span class="figure-number">Figure 18: </span>Obtain coupling terms of the transmissibility matrix</p>
</div>
</div>
</div>


<div id="outline-container-org2929b71" class="outline-3">
<h3 id="org2929b71"><span class="section-number-3">1.11</span> Robustness to a change of actuator position</h3>
<div class="outline-text-3" id="text-1-11">
<p>
<a id="org5192f2d"></a>
</p>

<p>
Let say we change the position of the actuators:
</p>
<div class="org-src-container">
<pre class="src src-matlab">la = l<span class="org-type">/</span>2<span class="org-type">*</span>0.7; <span class="org-comment">% Position of Act. [m]</span>
ha = h<span class="org-type">/</span>2<span class="org-type">*</span>0.7; <span class="org-comment">% Position of Act. [m]</span>
</pre>
</div>

<p>
The new plant is computed, and the centralized and SVD control architectures are applied using the previously computed Jacobian matrices and \(U\) and \(V\) matrices.
</p>

<p>
The closed-loop system are still stable in both cases, and the obtained transmissibility are equivalent as shown in Figure <a href="#orga9cfbd9">19</a>.
</p>


<div id="orga9cfbd9" class="figure">
<p><img src="figs/gravimeter_transmissibility_offset_act.png" alt="gravimeter_transmissibility_offset_act.png" />
</p>
<p><span class="figure-number">Figure 19: </span>Transmissibility for the initial CL system and when the position of  actuators are changed</p>
</div>
</div>
</div>

<div id="outline-container-org800bce5" class="outline-3">
<h3 id="org800bce5"><span class="section-number-3">1.12</span> Choice of the reference frame for Jacobian decoupling</h3>
<div class="outline-text-3" id="text-1-12">
<p>
<a id="orged8a91f"></a>
</p>
<p>
If we want to decouple the system at low frequency (determined by the stiffness matrix), we have to compute the Jacobian at a point where the stiffness matrix is diagonal.
A displacement (resp. rotation) of the mass at this particular point should induce a <b>pure</b> force (resp. torque) on the same point due to stiffnesses in the system.
This can be verified by geometrical computations.
</p>


<p>
If we want to decouple the system at high frequency (determined by the mass matrix), we have tot compute the Jacobians at the Center of Mass of the suspended solid.
Similarly to the stiffness analysis, when considering only the inertia effects (neglecting the stiffnesses), a force (resp. torque) applied at this point (the center of mass) should induce a <b>pure</b> acceleration (resp. angular acceleration).
</p>


<p>
Ideally, we would like to have a decoupled mass matrix and stiffness matrix at the same time.
To do so, the actuators (springs) should be positioned such that the stiffness matrix is diagonal when evaluated at the CoM of the solid.
</p>
</div>
<div id="outline-container-org816fe65" class="outline-4">
<h4 id="org816fe65"><span class="section-number-4">1.12.1</span> Decoupling of the mass matrix</h4>
<div class="outline-text-4" id="text-1-12-1">

<div id="orgf0e2d29" class="figure">
<p><img src="figs/gravimeter_model_M.png" alt="gravimeter_model_M.png" />
</p>
<p><span class="figure-number">Figure 20: </span>Choice of {O} such that the Mass Matrix is Diagonal</p>
</div>

<div class="org-src-container">
<pre class="src src-matlab">la = l<span class="org-type">/</span>2; <span class="org-comment">% Position of Act. [m]</span>
ha = h<span class="org-type">/</span>2; <span class="org-comment">% Position of Act. [m]</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-matlab"><span class="org-matlab-cellbreak"><span class="org-comment">%% Name of the Simulink File</span></span>
mdl = <span class="org-string">'gravimeter'</span>;

<span class="org-matlab-cellbreak"><span class="org-comment">%% Input/Output definition</span></span>
clear io; io_i = 1;
io(io_i) = linio([mdl, <span class="org-string">'/F1'</span>], 1, <span class="org-string">'openinput'</span>);  io_i = io_i <span class="org-type">+</span> 1;
io(io_i) = linio([mdl, <span class="org-string">'/F2'</span>], 1, <span class="org-string">'openinput'</span>);  io_i = io_i <span class="org-type">+</span> 1;
io(io_i) = linio([mdl, <span class="org-string">'/F3'</span>], 1, <span class="org-string">'openinput'</span>);  io_i = io_i <span class="org-type">+</span> 1;
io(io_i) = linio([mdl, <span class="org-string">'/Acc_side'</span>], 1, <span class="org-string">'openoutput'</span>); io_i = io_i <span class="org-type">+</span> 1;
io(io_i) = linio([mdl, <span class="org-string">'/Acc_side'</span>], 2, <span class="org-string">'openoutput'</span>); io_i = io_i <span class="org-type">+</span> 1;
io(io_i) = linio([mdl, <span class="org-string">'/Acc_top'</span>], 1, <span class="org-string">'openoutput'</span>); io_i = io_i <span class="org-type">+</span> 1;
io(io_i) = linio([mdl, <span class="org-string">'/Acc_top'</span>], 2, <span class="org-string">'openoutput'</span>); io_i = io_i <span class="org-type">+</span> 1;

G = linearize(mdl, io);
G.InputName  = {<span class="org-string">'F1'</span>, <span class="org-string">'F2'</span>, <span class="org-string">'F3'</span>};
G.OutputName = {<span class="org-string">'Ax1'</span>, <span class="org-string">'Ay1'</span>, <span class="org-string">'Ax2'</span>, <span class="org-string">'Ay2'</span>};
</pre>
</div>

<p>
Decoupling at the CoM (Mass decoupled)
</p>
<div class="org-src-container">
<pre class="src src-matlab">JMa = [1 0 <span class="org-type">-</span>h<span class="org-type">/</span>2
       0 1  l<span class="org-type">/</span>2
       1 0  h<span class="org-type">/</span>2
       0 1  0];

JMt = [1 0 <span class="org-type">-</span>ha
       0 1  la
       0 1 <span class="org-type">-</span>la];
</pre>
</div>

<div class="org-src-container">
<pre class="src src-matlab">GM = pinv(JMa)<span class="org-type">*</span>G<span class="org-type">*</span>pinv(JMt<span class="org-type">'</span>);
GM.InputName  = {<span class="org-string">'Fx'</span>, <span class="org-string">'Fy'</span>, <span class="org-string">'Mz'</span>};
GM.OutputName  = {<span class="org-string">'Dx'</span>, <span class="org-string">'Dy'</span>, <span class="org-string">'Rz'</span>};
</pre>
</div>


<div id="org64278e0" class="figure">
<p><img src="figs/jac_decoupling_M.png" alt="jac_decoupling_M.png" />
</p>
<p><span class="figure-number">Figure 21: </span>Diagonal and off-diagonal elements of the decoupled plant</p>
</div>
</div>
</div>

<div id="outline-container-org9726b8e" class="outline-4">
<h4 id="org9726b8e"><span class="section-number-4">1.12.2</span> Decoupling of the stiffness matrix</h4>
<div class="outline-text-4" id="text-1-12-2">

<div id="orga7e5cb4" class="figure">
<p><img src="figs/gravimeter_model_K.png" alt="gravimeter_model_K.png" />
</p>
<p><span class="figure-number">Figure 22: </span>Choice of {O} such that the Stiffness Matrix is Diagonal</p>
</div>

<p>
Decoupling at the point where K is diagonal (x = 0, y = -h/2 from the schematic {O} frame):
</p>
<div class="org-src-container">
<pre class="src src-matlab">JKa = [1 0  0
       0 1 <span class="org-type">-</span>l<span class="org-type">/</span>2
       1 0 <span class="org-type">-</span>h
       0 1  0];

JKt = [1 0  0
       0 1 <span class="org-type">-</span>la
       0 1  la];
</pre>
</div>

<p>
And the plant \(\bm{G}_x\) is computed:
</p>
<div class="org-src-container">
<pre class="src src-matlab">GK = pinv(JKa)<span class="org-type">*</span>G<span class="org-type">*</span>pinv(JKt<span class="org-type">'</span>);
GK.InputName  = {<span class="org-string">'Fx'</span>, <span class="org-string">'Fy'</span>, <span class="org-string">'Mz'</span>};
GK.OutputName  = {<span class="org-string">'Dx'</span>, <span class="org-string">'Dy'</span>, <span class="org-string">'Rz'</span>};
</pre>
</div>


<div id="org9be0f60" class="figure">
<p><img src="figs/jac_decoupling_K.png" alt="jac_decoupling_K.png" />
</p>
<p><span class="figure-number">Figure 23: </span>Diagonal and off-diagonal elements of the decoupled plant</p>
</div>
</div>
</div>

<div id="outline-container-org7bd15d6" class="outline-4">
<h4 id="org7bd15d6"><span class="section-number-4">1.12.3</span> Combined decoupling of the mass and stiffness matrices</h4>
<div class="outline-text-4" id="text-1-12-3">

<div id="org9565d30" class="figure">
<p><img src="figs/gravimeter_model_KM.png" alt="gravimeter_model_KM.png" />
</p>
<p><span class="figure-number">Figure 24: </span>Ideal location of the actuators such that both the mass and stiffness matrices are diagonal</p>
</div>

<p>
To do so, the actuator position should be modified
</p>

<div class="org-src-container">
<pre class="src src-matlab">la = l<span class="org-type">/</span>2; <span class="org-comment">% Position of Act. [m]</span>
ha = 0; <span class="org-comment">% Position of Act. [m]</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-matlab"><span class="org-matlab-cellbreak"><span class="org-comment">%% Name of the Simulink File</span></span>
mdl = <span class="org-string">'gravimeter'</span>;

<span class="org-matlab-cellbreak"><span class="org-comment">%% Input/Output definition</span></span>
clear io; io_i = 1;
io(io_i) = linio([mdl, <span class="org-string">'/F1'</span>], 1, <span class="org-string">'openinput'</span>);  io_i = io_i <span class="org-type">+</span> 1;
io(io_i) = linio([mdl, <span class="org-string">'/F2'</span>], 1, <span class="org-string">'openinput'</span>);  io_i = io_i <span class="org-type">+</span> 1;
io(io_i) = linio([mdl, <span class="org-string">'/F3'</span>], 1, <span class="org-string">'openinput'</span>);  io_i = io_i <span class="org-type">+</span> 1;
io(io_i) = linio([mdl, <span class="org-string">'/Acc_side'</span>], 1, <span class="org-string">'openoutput'</span>); io_i = io_i <span class="org-type">+</span> 1;
io(io_i) = linio([mdl, <span class="org-string">'/Acc_side'</span>], 2, <span class="org-string">'openoutput'</span>); io_i = io_i <span class="org-type">+</span> 1;
io(io_i) = linio([mdl, <span class="org-string">'/Acc_top'</span>], 1, <span class="org-string">'openoutput'</span>); io_i = io_i <span class="org-type">+</span> 1;
io(io_i) = linio([mdl, <span class="org-string">'/Acc_top'</span>], 2, <span class="org-string">'openoutput'</span>); io_i = io_i <span class="org-type">+</span> 1;

G = linearize(mdl, io);
G.InputName  = {<span class="org-string">'F1'</span>, <span class="org-string">'F2'</span>, <span class="org-string">'F3'</span>};
G.OutputName = {<span class="org-string">'Ax1'</span>, <span class="org-string">'Ay1'</span>, <span class="org-string">'Ax2'</span>, <span class="org-string">'Ay2'</span>};
</pre>
</div>

<div class="org-src-container">
<pre class="src src-matlab">JMa = [1 0 <span class="org-type">-</span>h<span class="org-type">/</span>2
       0 1  l<span class="org-type">/</span>2
       1 0  h<span class="org-type">/</span>2
       0 1  0];

JMt = [1 0 <span class="org-type">-</span>ha
       0 1  la
       0 1 <span class="org-type">-</span>la];
</pre>
</div>

<div class="org-src-container">
<pre class="src src-matlab">GKM = pinv(JMa)<span class="org-type">*</span>G<span class="org-type">*</span>pinv(JMt<span class="org-type">'</span>);
GKM.InputName  = {<span class="org-string">'Fx'</span>, <span class="org-string">'Fy'</span>, <span class="org-string">'Mz'</span>};
GKM.OutputName  = {<span class="org-string">'Dx'</span>, <span class="org-string">'Dy'</span>, <span class="org-string">'Rz'</span>};
</pre>
</div>


<div id="org41a3038" class="figure">
<p><img src="figs/jac_decoupling_KM.png" alt="jac_decoupling_KM.png" />
</p>
<p><span class="figure-number">Figure 25: </span>Diagonal and off-diagonal elements of the decoupled plant</p>
</div>
</div>
</div>

<div id="outline-container-org0300070" class="outline-4">
<h4 id="org0300070"><span class="section-number-4">1.12.4</span> Conclusion</h4>
<div class="outline-text-4" id="text-1-12-4">
<p>
Ideally, the mechanical system should be designed in order to have a decoupled stiffness matrix at the CoM of the solid.
</p>

<p>
If not the case, the system can either be decoupled as low frequency if the Jacobian are evaluated at a point where the stiffness matrix is decoupled.
Or it can be decoupled at high frequency if the Jacobians are evaluated at the CoM.
</p>
</div>
</div>
</div>

<div id="outline-container-org5b4203f" class="outline-3">
<h3 id="org5b4203f"><span class="section-number-3">1.13</span> SVD decoupling performances</h3>
<div class="outline-text-3" id="text-1-13">
<p>
<a id="orgdb22a9c"></a>
As the SVD is applied on a <b>real approximation</b> of the plant dynamics at a frequency \(\omega_0\), it is foreseen that the effectiveness of the decoupling depends on the validity of the real approximation.
</p>

<p>
Let&rsquo;s do the SVD decoupling on a plant that is mostly real (low damping) and one with a large imaginary part (larger damping).
</p>

<p>
Start with small damping, the obtained diagonal and off-diagonal terms are shown in Figure <a href="#orgbab4c0c">26</a>.
</p>
<div class="org-src-container">
<pre class="src src-matlab">c = 2e1; <span class="org-comment">% Actuator Damping [N/(m/s)]</span>
</pre>
</div>


<div id="orgbab4c0c" class="figure">
<p><img src="figs/gravimeter_svd_low_damping.png" alt="gravimeter_svd_low_damping.png" />
</p>
<p><span class="figure-number">Figure 26: </span>Diagonal and off-diagonal term when decoupling with SVD on the gravimeter with small damping</p>
</div>

<p>
Now take a larger damping, the obtained diagonal and off-diagonal terms are shown in Figure <a href="#org7fb0be8">27</a>.
</p>
<div class="org-src-container">
<pre class="src src-matlab">c = 5e2; <span class="org-comment">% Actuator Damping [N/(m/s)]</span>
</pre>
</div>


<div id="org7fb0be8" class="figure">
<p><img src="figs/gravimeter_svd_high_damping.png" alt="gravimeter_svd_high_damping.png" />
</p>
<p><span class="figure-number">Figure 27: </span>Diagonal and off-diagonal term when decoupling with SVD on the gravimeter with high damping</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org401104a" class="outline-2">
<h2 id="org401104a"><span class="section-number-2">2</span> Stewart Platform - Simscape Model</h2>
<div class="outline-text-2" id="text-2">
<p>
<a id="org7d4869d"></a>
</p>
<p>
In this analysis, we wish to applied SVD control to the Stewart Platform shown in Figure <a href="#org8421227">28</a>.
</p>

<p>
Some notes about the system:
</p>
<ul class="org-ul">
<li>6 voice coils actuators are used to control the motion of the top platform.</li>
<li>the motion of the top platform is measured with a 6-axis inertial unit (3 acceleration + 3 angular accelerations)</li>
<li>the control objective is to isolate the top platform from vibrations coming from the bottom platform</li>
</ul>


<div id="org8421227" class="figure">
<p><img src="figs/SP_assembly.png" alt="SP_assembly.png" />
</p>
<p><span class="figure-number">Figure 28: </span>Stewart Platform CAD View</p>
</div>

<p>
The analysis of the SVD/Jacobian control applied to the Stewart platform is performed in the following sections:
</p>
<ul class="org-ul">
<li>Section <a href="#org6744616">2.1</a>: The parameters of the Simscape model of the Stewart platform are defined</li>
<li>Section <a href="#org8d7a0a7">2.2</a>: The plant is identified from the Simscape model and the system coupling is shown</li>
<li>Section <a href="#org0547f0c">2.3</a>: The plant is first decoupled using the Jacobian</li>
<li>Section <a href="#org979274e">2.4</a>: The decoupling is performed thanks to the SVD. To do so a real approximation of the plant is computed.</li>
<li>Section <a href="#org0798b19">2.5</a>: The effectiveness of the decoupling with the Jacobian and SVD are compared using the Gershorin Radii</li>
<li>Section <a href="#orge342d34">2.6</a>:</li>
<li>Section <a href="#org1937718">2.7</a>: The dynamics of the decoupled plants are shown</li>
<li>Section <a href="#org6db56c8">2.8</a>: A diagonal controller is defined to control the decoupled plant</li>
<li>Section <a href="#org75ee3eb">2.9</a>: Finally, the closed loop system properties are studied</li>
</ul>
</div>

<div id="outline-container-org8c29905" class="outline-3">
<h3 id="org8c29905"><span class="section-number-3">2.1</span> Simscape Model - Parameters</h3>
<div class="outline-text-3" id="text-2-1">
<p>
<a id="org6744616"></a>
</p>
<div class="org-src-container">
<pre class="src src-matlab">open(<span class="org-string">'drone_platform.slx'</span>);
</pre>
</div>

<p>
Definition of spring parameters:
</p>
<div class="org-src-container">
<pre class="src src-matlab">kx = 0.5<span class="org-type">*</span>1e3<span class="org-type">/</span>3; <span class="org-comment">% [N/m]</span>
ky = 0.5<span class="org-type">*</span>1e3<span class="org-type">/</span>3;
kz = 1e3<span class="org-type">/</span>3;

cx = 0.025; <span class="org-comment">% [Nm/rad]</span>
cy = 0.025;
cz = 0.025;
</pre>
</div>

<p>
We suppose the sensor is perfectly positioned.
</p>
<div class="org-src-container">
<pre class="src src-matlab">sens_pos_error = zeros(3,1);
</pre>
</div>

<p>
Gravity:
</p>
<div class="org-src-container">
<pre class="src src-matlab">g = 0;
</pre>
</div>

<p>
We load the Jacobian (previously computed from the geometry):
</p>
<div class="org-src-container">
<pre class="src src-matlab">load(<span class="org-string">'jacobian.mat'</span>, <span class="org-string">'Aa'</span>, <span class="org-string">'Ab'</span>, <span class="org-string">'As'</span>, <span class="org-string">'l'</span>, <span class="org-string">'J'</span>);
</pre>
</div>

<p>
We initialize other parameters:
</p>
<div class="org-src-container">
<pre class="src src-matlab">U = eye(6);
V = eye(6);
Kc = tf(zeros(6));
</pre>
</div>


<div id="org3dd3992" class="figure">
<p><img src="figs/stewart_simscape.png" alt="stewart_simscape.png" />
</p>
<p><span class="figure-number">Figure 29: </span>General view of the Simscape Model</p>
</div>


<div id="orgbf881eb" class="figure">
<p><img src="figs/stewart_platform_details.png" alt="stewart_platform_details.png" />
</p>
<p><span class="figure-number">Figure 30: </span>Simscape model of the Stewart platform</p>
</div>
</div>
</div>

<div id="outline-container-orgd384200" class="outline-3">
<h3 id="orgd384200"><span class="section-number-3">2.2</span> Identification of the plant</h3>
<div class="outline-text-3" id="text-2-2">
<p>
<a id="org8d7a0a7"></a>
</p>

<p>
The plant shown in Figure <a href="#org896add0">31</a> is identified from the Simscape model.
</p>

<p>
The inputs are:
</p>
<ul class="org-ul">
<li>\(D_w\) translation and rotation of the bottom platform (with respect to the center of mass of the top platform)</li>
<li>\(\tau\) the 6 forces applied by the voice coils</li>
</ul>

<p>
The outputs are the 6 accelerations measured by the inertial unit.
</p>


<div id="org896add0" class="figure">
<p><img src="figs/stewart_platform_plant.png" alt="stewart_platform_plant.png" />
</p>
<p><span class="figure-number">Figure 31: </span>Considered plant \(\bm{G} = \begin{bmatrix}G_d\\G_u\end{bmatrix}\). \(D_w\) is the translation/rotation of the support, \(\tau\) the actuator forces, \(a\) the acceleration/angular acceleration of the top platform</p>
</div>

<div class="org-src-container">
<pre class="src src-matlab"><span class="org-matlab-cellbreak"><span class="org-comment">%% Name of the Simulink File</span></span>
mdl = <span class="org-string">'drone_platform'</span>;

<span class="org-matlab-cellbreak"><span class="org-comment">%% Input/Output definition</span></span>
clear io; io_i = 1;
io(io_i) = linio([mdl, <span class="org-string">'/Dw'</span>],              1, <span class="org-string">'openinput'</span>);  io_i = io_i <span class="org-type">+</span> 1; <span class="org-comment">% Ground Motion</span>
io(io_i) = linio([mdl, <span class="org-string">'/V-T'</span>],             1, <span class="org-string">'openinput'</span>);  io_i = io_i <span class="org-type">+</span> 1; <span class="org-comment">% Actuator Forces</span>
io(io_i) = linio([mdl, <span class="org-string">'/Inertial Sensor'</span>], 1, <span class="org-string">'openoutput'</span>); io_i = io_i <span class="org-type">+</span> 1; <span class="org-comment">% Top platform acceleration</span>

G = linearize(mdl, io);
G.InputName  = {<span class="org-string">'Dwx'</span>, <span class="org-string">'Dwy'</span>, <span class="org-string">'Dwz'</span>, <span class="org-string">'Rwx'</span>, <span class="org-string">'Rwy'</span>, <span class="org-string">'Rwz'</span>, ...
                <span class="org-string">'F1'</span>, <span class="org-string">'F2'</span>, <span class="org-string">'F3'</span>, <span class="org-string">'F4'</span>, <span class="org-string">'F5'</span>, <span class="org-string">'F6'</span>};
G.OutputName = {<span class="org-string">'Ax'</span>, <span class="org-string">'Ay'</span>, <span class="org-string">'Az'</span>, <span class="org-string">'Arx'</span>, <span class="org-string">'Ary'</span>, <span class="org-string">'Arz'</span>};

<span class="org-comment">% Plant</span>
Gu = G(<span class="org-type">:</span>, {<span class="org-string">'F1'</span>, <span class="org-string">'F2'</span>, <span class="org-string">'F3'</span>, <span class="org-string">'F4'</span>, <span class="org-string">'F5'</span>, <span class="org-string">'F6'</span>});
<span class="org-comment">% Disturbance dynamics</span>
Gd = G(<span class="org-type">:</span>, {<span class="org-string">'Dwx'</span>, <span class="org-string">'Dwy'</span>, <span class="org-string">'Dwz'</span>, <span class="org-string">'Rwx'</span>, <span class="org-string">'Rwy'</span>, <span class="org-string">'Rwz'</span>});
</pre>
</div>

<p>
There are 24 states (6dof for the bottom platform + 6dof for the top platform).
</p>
<div class="org-src-container">
<pre class="src src-matlab">size(G)
</pre>
</div>

<pre class="example">
State-space model with 6 outputs, 12 inputs, and 24 states.
</pre>


<p>
The elements of the transfer matrix \(\bm{G}\) corresponding to the transfer function from actuator forces \(\tau\) to the measured acceleration \(a\) are shown in Figure <a href="#org152ce20">32</a>.
</p>

<p>
One can easily see that the system is strongly coupled.
</p>


<div id="org152ce20" class="figure">
<p><img src="figs/stewart_platform_coupled_plant.png" alt="stewart_platform_coupled_plant.png" />
</p>
<p><span class="figure-number">Figure 32: </span>Magnitude of all 36 elements of the transfer function matrix \(G_u\)</p>
</div>
</div>
</div>

<div id="outline-container-orge1bb646" class="outline-3">
<h3 id="orge1bb646"><span class="section-number-3">2.3</span> Decoupling using the Jacobian</h3>
<div class="outline-text-3" id="text-2-3">
<p>
<a id="org0547f0c"></a>
Consider the control architecture shown in Figure <a href="#org2e03cc6">33</a>.
The Jacobian matrix is used to transform forces/torques applied on the top platform to the equivalent forces applied by each actuator.
</p>

<p>
The Jacobian matrix is computed from the geometry of the platform (position and orientation of the actuators).
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 4:</span> Computed Jacobian Matrix</caption>

<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">0.811</td>
<td class="org-right">0.0</td>
<td class="org-right">0.584</td>
<td class="org-right">-0.018</td>
<td class="org-right">-0.008</td>
<td class="org-right">0.025</td>
</tr>

<tr>
<td class="org-right">-0.406</td>
<td class="org-right">-0.703</td>
<td class="org-right">0.584</td>
<td class="org-right">-0.016</td>
<td class="org-right">-0.012</td>
<td class="org-right">-0.025</td>
</tr>

<tr>
<td class="org-right">-0.406</td>
<td class="org-right">0.703</td>
<td class="org-right">0.584</td>
<td class="org-right">0.016</td>
<td class="org-right">-0.012</td>
<td class="org-right">0.025</td>
</tr>

<tr>
<td class="org-right">0.811</td>
<td class="org-right">0.0</td>
<td class="org-right">0.584</td>
<td class="org-right">0.018</td>
<td class="org-right">-0.008</td>
<td class="org-right">-0.025</td>
</tr>

<tr>
<td class="org-right">-0.406</td>
<td class="org-right">-0.703</td>
<td class="org-right">0.584</td>
<td class="org-right">0.002</td>
<td class="org-right">0.019</td>
<td class="org-right">0.025</td>
</tr>

<tr>
<td class="org-right">-0.406</td>
<td class="org-right">0.703</td>
<td class="org-right">0.584</td>
<td class="org-right">-0.002</td>
<td class="org-right">0.019</td>
<td class="org-right">-0.025</td>
</tr>
</tbody>
</table>


<div id="org2e03cc6" class="figure">
<p><img src="figs/plant_decouple_jacobian.png" alt="plant_decouple_jacobian.png" />
</p>
<p><span class="figure-number">Figure 33: </span>Decoupled plant \(\bm{G}_x\) using the Jacobian matrix \(J\)</p>
</div>

<p>
We define a new plant:
\[ G_x(s) = G(s) J^{-T} \]
</p>

<p>
\(G_x(s)\) correspond to the transfer function from forces and torques applied to the top platform to the absolute acceleration of the top platform.
</p>

<div class="org-src-container">
<pre class="src src-matlab">Gx = Gu<span class="org-type">*</span>inv(J<span class="org-type">'</span>);
Gx.InputName  = {<span class="org-string">'Fx'</span>, <span class="org-string">'Fy'</span>, <span class="org-string">'Fz'</span>, <span class="org-string">'Mx'</span>, <span class="org-string">'My'</span>, <span class="org-string">'Mz'</span>};
</pre>
</div>
</div>
</div>

<div id="outline-container-org930cb6d" class="outline-3">
<h3 id="org930cb6d"><span class="section-number-3">2.4</span> Decoupling using the SVD</h3>
<div class="outline-text-3" id="text-2-4">
<p>
<a id="org979274e"></a>
</p>

<p>
In order to decouple the plant using the SVD, first a real approximation of the plant transfer function matrix as the crossover frequency is required.
</p>

<p>
Let&rsquo;s compute a real approximation of the complex matrix \(H_1\) which corresponds to the the transfer function \(G_u(j\omega_c)\) from forces applied by the actuators to the measured acceleration of the top platform evaluated at the frequency \(\omega_c\).
</p>
<div class="org-src-container">
<pre class="src src-matlab">wc = 2<span class="org-type">*</span><span class="org-constant">pi</span><span class="org-type">*</span>30; <span class="org-comment">% Decoupling frequency [rad/s]</span>

H1 = evalfr(Gu, <span class="org-constant">j</span><span class="org-type">*</span>wc);
</pre>
</div>

<p>
The real approximation is computed as follows:
</p>
<div class="org-src-container">
<pre class="src src-matlab">D = pinv(real(H1<span class="org-type">'*</span>H1));
H1 = inv(D<span class="org-type">*</span>real(H1<span class="org-type">'*</span>diag(exp(<span class="org-constant">j</span><span class="org-type">*</span>angle(diag(H1<span class="org-type">*</span>D<span class="org-type">*</span>H1<span class="org-type">.'</span>))<span class="org-type">/</span>2))));
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 5:</span> Real approximate of \(G\) at the decoupling frequency \(\omega_c\)</caption>

<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">4.4</td>
<td class="org-right">-2.1</td>
<td class="org-right">-2.1</td>
<td class="org-right">4.4</td>
<td class="org-right">-2.4</td>
<td class="org-right">-2.4</td>
</tr>

<tr>
<td class="org-right">-0.2</td>
<td class="org-right">-3.9</td>
<td class="org-right">3.9</td>
<td class="org-right">0.2</td>
<td class="org-right">-3.8</td>
<td class="org-right">3.8</td>
</tr>

<tr>
<td class="org-right">3.4</td>
<td class="org-right">3.4</td>
<td class="org-right">3.4</td>
<td class="org-right">3.4</td>
<td class="org-right">3.4</td>
<td class="org-right">3.4</td>
</tr>

<tr>
<td class="org-right">-367.1</td>
<td class="org-right">-323.8</td>
<td class="org-right">323.8</td>
<td class="org-right">367.1</td>
<td class="org-right">43.3</td>
<td class="org-right">-43.3</td>
</tr>

<tr>
<td class="org-right">-162.0</td>
<td class="org-right">-237.0</td>
<td class="org-right">-237.0</td>
<td class="org-right">-162.0</td>
<td class="org-right">398.9</td>
<td class="org-right">398.9</td>
</tr>

<tr>
<td class="org-right">220.6</td>
<td class="org-right">-220.6</td>
<td class="org-right">220.6</td>
<td class="org-right">-220.6</td>
<td class="org-right">220.6</td>
<td class="org-right">-220.6</td>
</tr>
</tbody>
</table>


<p>
Note that the plant \(G_u\) at \(\omega_c\) is already an almost real matrix.
This can be seen on the Bode plots where the phase is close to 1.
This can be verified below where only the real value of \(G_u(\omega_c)\) is shown
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 6:</span> Real part of \(G\) at the decoupling frequency \(\omega_c\)</caption>

<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">4.4</td>
<td class="org-right">-2.1</td>
<td class="org-right">-2.1</td>
<td class="org-right">4.4</td>
<td class="org-right">-2.4</td>
<td class="org-right">-2.4</td>
</tr>

<tr>
<td class="org-right">-0.2</td>
<td class="org-right">-3.9</td>
<td class="org-right">3.9</td>
<td class="org-right">0.2</td>
<td class="org-right">-3.8</td>
<td class="org-right">3.8</td>
</tr>

<tr>
<td class="org-right">3.4</td>
<td class="org-right">3.4</td>
<td class="org-right">3.4</td>
<td class="org-right">3.4</td>
<td class="org-right">3.4</td>
<td class="org-right">3.4</td>
</tr>

<tr>
<td class="org-right">-367.1</td>
<td class="org-right">-323.8</td>
<td class="org-right">323.8</td>
<td class="org-right">367.1</td>
<td class="org-right">43.3</td>
<td class="org-right">-43.3</td>
</tr>

<tr>
<td class="org-right">-162.0</td>
<td class="org-right">-237.0</td>
<td class="org-right">-237.0</td>
<td class="org-right">-162.0</td>
<td class="org-right">398.9</td>
<td class="org-right">398.9</td>
</tr>

<tr>
<td class="org-right">220.6</td>
<td class="org-right">-220.6</td>
<td class="org-right">220.6</td>
<td class="org-right">-220.6</td>
<td class="org-right">220.6</td>
<td class="org-right">-220.6</td>
</tr>
</tbody>
</table>

<p>
Now, the Singular Value Decomposition of \(H_1\) is performed:
\[ H_1 = U \Sigma V^H \]
</p>

<div class="org-src-container">
<pre class="src src-matlab">[U,<span class="org-type">~</span>,V] = svd(H1);
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 7:</span> Obtained matrix \(U\)</caption>

<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">-0.005</td>
<td class="org-right">7e-06</td>
<td class="org-right">6e-11</td>
<td class="org-right">-3e-06</td>
<td class="org-right">-1</td>
<td class="org-right">0.1</td>
</tr>

<tr>
<td class="org-right">-7e-06</td>
<td class="org-right">-0.005</td>
<td class="org-right">-9e-09</td>
<td class="org-right">-5e-09</td>
<td class="org-right">-0.1</td>
<td class="org-right">-1</td>
</tr>

<tr>
<td class="org-right">4e-08</td>
<td class="org-right">-2e-10</td>
<td class="org-right">-6e-11</td>
<td class="org-right">-1</td>
<td class="org-right">3e-06</td>
<td class="org-right">-3e-07</td>
</tr>

<tr>
<td class="org-right">-0.002</td>
<td class="org-right">-1</td>
<td class="org-right">-5e-06</td>
<td class="org-right">2e-10</td>
<td class="org-right">0.0006</td>
<td class="org-right">0.005</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-right">-0.002</td>
<td class="org-right">-1e-08</td>
<td class="org-right">2e-08</td>
<td class="org-right">-0.005</td>
<td class="org-right">0.0006</td>
</tr>

<tr>
<td class="org-right">-4e-09</td>
<td class="org-right">5e-06</td>
<td class="org-right">-1</td>
<td class="org-right">6e-11</td>
<td class="org-right">-2e-09</td>
<td class="org-right">-1e-08</td>
</tr>
</tbody>
</table>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 8:</span> Obtained matrix \(V\)</caption>

<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">-0.2</td>
<td class="org-right">0.5</td>
<td class="org-right">-0.4</td>
<td class="org-right">-0.4</td>
<td class="org-right">-0.6</td>
<td class="org-right">-0.2</td>
</tr>

<tr>
<td class="org-right">-0.3</td>
<td class="org-right">0.5</td>
<td class="org-right">0.4</td>
<td class="org-right">-0.4</td>
<td class="org-right">0.5</td>
<td class="org-right">0.3</td>
</tr>

<tr>
<td class="org-right">-0.3</td>
<td class="org-right">-0.5</td>
<td class="org-right">-0.4</td>
<td class="org-right">-0.4</td>
<td class="org-right">0.4</td>
<td class="org-right">-0.4</td>
</tr>

<tr>
<td class="org-right">-0.2</td>
<td class="org-right">-0.5</td>
<td class="org-right">0.4</td>
<td class="org-right">-0.4</td>
<td class="org-right">-0.5</td>
<td class="org-right">0.3</td>
</tr>

<tr>
<td class="org-right">0.6</td>
<td class="org-right">-0.06</td>
<td class="org-right">-0.4</td>
<td class="org-right">-0.4</td>
<td class="org-right">0.1</td>
<td class="org-right">0.6</td>
</tr>

<tr>
<td class="org-right">0.6</td>
<td class="org-right">0.06</td>
<td class="org-right">0.4</td>
<td class="org-right">-0.4</td>
<td class="org-right">-0.006</td>
<td class="org-right">-0.6</td>
</tr>
</tbody>
</table>

<p>
The obtained matrices \(U\) and \(V\) are used to decouple the system as shown in Figure <a href="#org8cd7409">34</a>.
</p>


<div id="org8cd7409" class="figure">
<p><img src="figs/plant_decouple_svd.png" alt="plant_decouple_svd.png" />
</p>
<p><span class="figure-number">Figure 34: </span>Decoupled plant \(\bm{G}_{SVD}\) using the Singular Value Decomposition</p>
</div>

<p>
The decoupled plant is then:
\[ G_{SVD}(s) = U^{-1} G_u(s) V^{-H} \]
</p>

<div class="org-src-container">
<pre class="src src-matlab">Gsvd = inv(U)<span class="org-type">*</span>Gu<span class="org-type">*</span>inv(V<span class="org-type">'</span>);
</pre>
</div>
</div>
</div>

<div id="outline-container-org04da43f" class="outline-3">
<h3 id="org04da43f"><span class="section-number-3">2.5</span> Verification of the decoupling using the &ldquo;Gershgorin Radii&rdquo;</h3>
<div class="outline-text-3" id="text-2-5">
<p>
<a id="org0798b19"></a>
</p>

<p>
The &ldquo;Gershgorin Radii&rdquo; is computed for the coupled plant \(G(s)\), for the &ldquo;Jacobian plant&rdquo; \(G_x(s)\) and the &ldquo;SVD Decoupled Plant&rdquo; \(G_{SVD}(s)\):
</p>

<p>
The &ldquo;Gershgorin Radii&rdquo; of a matrix \(S\) is defined by:
\[ \zeta_i(j\omega) = \frac{\sum\limits_{j\neq i}|S_{ij}(j\omega)|}{|S_{ii}(j\omega)|} \]
</p>

<p>
This is computed over the following frequencies.
</p>

<div id="org70763fb" class="figure">
<p><img src="figs/simscape_model_gershgorin_radii.png" alt="simscape_model_gershgorin_radii.png" />
</p>
<p><span class="figure-number">Figure 35: </span>Gershgorin Radii of the Coupled and Decoupled plants</p>
</div>
</div>
</div>

<div id="outline-container-org0ef874f" class="outline-3">
<h3 id="org0ef874f"><span class="section-number-3">2.6</span> Verification of the decoupling using the &ldquo;Relative Gain Array&rdquo;</h3>
<div class="outline-text-3" id="text-2-6">
<p>
<a id="orge342d34"></a>
</p>

<p>
The relative gain array (RGA) is defined as:
</p>
\begin{equation}
  \Lambda\big(G(s)\big) = G(s) \times \big( G(s)^{-1} \big)^T
\end{equation}
<p>
where \(\times\) denotes an element by element multiplication and \(G(s)\) is an \(n \times n\) square transfer matrix.
</p>

<p>
The obtained RGA elements are shown in Figure <a href="#org64c02c5">36</a>.
</p>


<div id="org64c02c5" class="figure">
<p><img src="figs/simscape_model_rga.png" alt="simscape_model_rga.png" />
</p>
<p><span class="figure-number">Figure 36: </span>Obtained norm of RGA elements for the SVD decoupled plant and the Jacobian decoupled plant</p>
</div>
</div>
</div>

<div id="outline-container-orgd18fc2b" class="outline-3">
<h3 id="orgd18fc2b"><span class="section-number-3">2.7</span> Obtained Decoupled Plants</h3>
<div class="outline-text-3" id="text-2-7">
<p>
<a id="org1937718"></a>
</p>

<p>
The bode plot of the diagonal and off-diagonal elements of \(G_{SVD}\) are shown in Figure <a href="#org3a13489">37</a>.
</p>


<div id="org3a13489" class="figure">
<p><img src="figs/simscape_model_decoupled_plant_svd.png" alt="simscape_model_decoupled_plant_svd.png" />
</p>
<p><span class="figure-number">Figure 37: </span>Decoupled Plant using SVD</p>
</div>

<p>
Similarly, the bode plots of the diagonal elements and off-diagonal elements of the decoupled plant \(G_x(s)\) using the Jacobian are shown in Figure <a href="#org33aaa46">38</a>.
</p>


<div id="org33aaa46" class="figure">
<p><img src="figs/simscape_model_decoupled_plant_jacobian.png" alt="simscape_model_decoupled_plant_jacobian.png" />
</p>
<p><span class="figure-number">Figure 38: </span>Stewart Platform Plant from forces (resp. torques) applied by the legs to the acceleration (resp. angular acceleration) of the platform as well as all the coupling terms between the two (non-diagonal terms of the transfer function matrix)</p>
</div>
</div>
</div>

<div id="outline-container-org1bfaa13" class="outline-3">
<h3 id="org1bfaa13"><span class="section-number-3">2.8</span> Diagonal Controller</h3>
<div class="outline-text-3" id="text-2-8">
<p>
<a id="org6db56c8"></a>
The control diagram for the centralized control is shown in Figure <a href="#orgfb038a6">39</a>.
</p>

<p>
The controller \(K_c\) is &ldquo;working&rdquo; in an cartesian frame.
The Jacobian is used to convert forces in the cartesian frame to forces applied by the actuators.
</p>


<div id="orgfb038a6" class="figure">
<p><img src="figs/centralized_control.png" alt="centralized_control.png" />
</p>
<p><span class="figure-number">Figure 39: </span>Control Diagram for the Centralized control</p>
</div>

<p>
The SVD control architecture is shown in Figure <a href="#org0ac9254">40</a>.
The matrices \(U\) and \(V\) are used to decoupled the plant \(G\).
</p>


<div id="org0ac9254" class="figure">
<p><img src="figs/svd_control.png" alt="svd_control.png" />
</p>
<p><span class="figure-number">Figure 40: </span>Control Diagram for the SVD control</p>
</div>


<p>
We choose the controller to be a low pass filter:
\[ K_c(s) = \frac{G_0}{1 + \frac{s}{\omega_0}} \]
</p>

<p>
\(G_0\) is tuned such that the crossover frequency corresponding to the diagonal terms of the loop gain is equal to \(\omega_c\)
</p>

<div class="org-src-container">
<pre class="src src-matlab">wc = 2<span class="org-type">*</span><span class="org-constant">pi</span><span class="org-type">*</span>80;  <span class="org-comment">% Crossover Frequency [rad/s]</span>
w0 = 2<span class="org-type">*</span><span class="org-constant">pi</span><span class="org-type">*</span>0.1; <span class="org-comment">% Controller Pole [rad/s]</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-matlab">K_cen = diag(1<span class="org-type">./</span>diag(abs(evalfr(Gx, <span class="org-constant">j</span><span class="org-type">*</span>wc))))<span class="org-type">*</span>(1<span class="org-type">/</span>abs(evalfr(1<span class="org-type">/</span>(1 <span class="org-type">+</span> s<span class="org-type">/</span>w0), <span class="org-constant">j</span><span class="org-type">*</span>wc)))<span class="org-type">/</span>(1 <span class="org-type">+</span> s<span class="org-type">/</span>w0);
L_cen = K_cen<span class="org-type">*</span>Gx;
G_cen = feedback(G, pinv(J<span class="org-type">'</span>)<span class="org-type">*</span>K_cen, [7<span class="org-type">:</span>12], [1<span class="org-type">:</span>6]);
</pre>
</div>

<div class="org-src-container">
<pre class="src src-matlab">K_svd = diag(1<span class="org-type">./</span>diag(abs(evalfr(Gsvd, <span class="org-constant">j</span><span class="org-type">*</span>wc))))<span class="org-type">*</span>(1<span class="org-type">/</span>abs(evalfr(1<span class="org-type">/</span>(1 <span class="org-type">+</span> s<span class="org-type">/</span>w0), <span class="org-constant">j</span><span class="org-type">*</span>wc)))<span class="org-type">/</span>(1 <span class="org-type">+</span> s<span class="org-type">/</span>w0);
L_svd = K_svd<span class="org-type">*</span>Gsvd;
G_svd = feedback(G, inv(V<span class="org-type">'</span>)<span class="org-type">*</span>K_svd<span class="org-type">*</span>inv(U), [7<span class="org-type">:</span>12], [1<span class="org-type">:</span>6]);
</pre>
</div>

<p>
The obtained diagonal elements of the loop gains are shown in Figure <a href="#orga186e36">41</a>.
</p>


<div id="orga186e36" class="figure">
<p><img src="figs/stewart_comp_loop_gain_diagonal.png" alt="stewart_comp_loop_gain_diagonal.png" />
</p>
<p><span class="figure-number">Figure 41: </span>Comparison of the diagonal elements of the loop gains for the SVD control architecture and the Jacobian one</p>
</div>
</div>
</div>

<div id="outline-container-orgac71008" class="outline-3">
<h3 id="orgac71008"><span class="section-number-3">2.9</span> Closed-Loop system Performances</h3>
<div class="outline-text-3" id="text-2-9">
<p>
<a id="org75ee3eb"></a>
</p>

<p>
Let&rsquo;s first verify the stability of the closed-loop systems:
</p>
<div class="org-src-container">
<pre class="src src-matlab">isstable(G_cen)
</pre>
</div>

<pre class="example">
ans =
  logical
   1
</pre>


<div class="org-src-container">
<pre class="src src-matlab">isstable(G_svd)
</pre>
</div>

<pre class="example">
ans =
  logical
   1
</pre>


<p>
The obtained transmissibility in Open-loop, for the centralized control as well as for the SVD control are shown in Figure <a href="#orgfc220f4">42</a>.
</p>


<div id="orgfc220f4" class="figure">
<p><img src="figs/stewart_platform_simscape_cl_transmissibility.png" alt="stewart_platform_simscape_cl_transmissibility.png" />
</p>
<p><span class="figure-number">Figure 42: </span>Obtained Transmissibility</p>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Dehaeze Thomas</p>
<p class="date">Created: 2021-01-11 lun. 09:44</p>
</div>
</body>
</html>
